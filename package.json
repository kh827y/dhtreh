{
  "name": "loyalty-monorepo",
  "private": true,
  "engines": {
    "node": ">=18.18.0",
    "pnpm": ">=9.0.0"
  },
  "scripts": {
    "dev:api": "pnpm --filter api start:dev",
    "dev:clean": "stdbuf -oL -eL pnpm --filter api start:dev 2>&1 | jq -Rr 'def c(x): \"\\u001b[\"+x+\"m\"; def reset: c(\"0\"); def c_status(s):(s|tonumber) as $n | (if $n>=500 then c(\"1;31\") elif $n>=400 then c(\"1;33\") elif $n>=300 then c(\"1;34\") else c(\"1;32\") end)+($n|tostring)+reset; . as $line | (try fromjson catch null) as $j | if $j != null and ($j.msg==\"request completed\") and ($j.req) and ($j.res) then \"\\($j.req.method) \\($j.req.url) \\(c_status($j.res.statusCode))\" else $line end'",
    "dev:admin": "pnpm --filter admin dev",
    "dev:cashier": "pnpm --filter cashier dev",
    "dev:miniapp": "pnpm --filter miniapp dev",
    "dev:portal": "pnpm --filter merchant-portal dev",
    "build:api": "pnpm --filter api build",
    "build:admin": "pnpm --filter admin build",
    "build:cashier": "pnpm --filter cashier build",
    "build:miniapp": "pnpm --filter miniapp build",
    "build:portal": "pnpm --filter merchant-portal build",
    "typecheck": "pnpm --filter api typecheck && pnpm --filter admin exec tsc --noEmit && pnpm --filter cashier exec tsc --noEmit && pnpm --filter miniapp exec tsc --noEmit && pnpm --filter merchant-portal exec tsc --noEmit",
    "lint": "pnpm --filter api lint && pnpm --filter admin lint && pnpm --filter cashier lint && pnpm --filter miniapp lint && pnpm --filter merchant-portal lint",
    "lint:fix": "pnpm --filter api lint --fix && pnpm --filter admin lint --fix && pnpm --filter cashier lint --fix && pnpm --filter miniapp lint --fix && pnpm --filter merchant-portal lint --fix",
    "format": "prettier -w .",
    "format:check": "prettier -c .",
    "audit:pages": "node scripts/audit-page-fetches.mjs",
    "check:error-budget": "bash scripts/check-error-budget.sh",
    "canary:rollout": "bash scripts/canary-rollout.sh",
    "load:portal": "node scripts/load-test-portal.mjs",
    "db:explain:hotpaths": "pnpm --filter api explain:hotpaths",
    "test": "pnpm --filter api test && pnpm --filter api test:e2e",
    "test:ci:all": "pnpm --filter api test && pnpm --filter api test:e2e && pnpm --filter admin test && pnpm --filter merchant-portal test && pnpm --filter cashier test && pnpm --filter miniapp test && pnpm --filter @loyalty/sdk-ts test",
    "dev:all": "pnpm -r --parallel --filter admin --filter merchant-portal --filter cashier --filter miniapp dev"
  },
  "devDependencies": {
    "eslint": "^9.18.0",
    "eslint-config-prettier": "^10.0.1",
    "eslint-plugin-prettier": "^5.2.2",
    "prettier": "^3.4.2"
  },
  "pnpm": {
    "overrides": {
      "node-forge": "1.3.2",
      "qs": "6.14.1",
      "gtoken>jws": "4.0.1",
      "google-auth-library>jws": "4.0.1",
      "jsonwebtoken>jws": "3.2.3",
      "@google-cloud/storage>fast-xml-parser": "5.3.4"
    }
  }
}
