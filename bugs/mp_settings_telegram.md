# Аудит: настройки Telegram уведомлений (merchant-portal)

Ниже перечислены проблемы и недоработки, отсортированные по убыванию важности устранения.

## Критично / безопасность

### 1) Инвайт‑токен многоразовый и не привязан к первому чату
- **Где**: `issueInvite()` и `handleStartToken()`.
- **Проблема**: токен действует до 30 дней и может использоваться неограниченным числом чатов/групп; он не помечается «использованным» и не привязывается к конкретному chatId. Даже после генерации нового токена уже подписанные чаты остаются активными.
- **Риск**: при утечке токена можно массово подключить посторонние чаты и получать уведомления; ревокация затруднена (нужно вручную искать и отключать подписчиков).
- **Как исправить**: сделать токен одноразовым (или ограничить число подключений), либо сразу после первого использования ротацией гасить токен; добавить понятный механизм глобальной ревокации всех активных подписок для мерчанта/сотрудника.
