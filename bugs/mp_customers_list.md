# Аудит: список клиентов в Merchant Portal

Ниже — найденные проблемы, отсортированные по убыванию критичности.

## P1 — Список клиентов ограничен 50 записями, поиск/пагинация работают только по первой странице
- UI запрашивает `/api/customers` без параметров `limit/offset` и далее режет данные на клиенте. API по умолчанию отдаёт не более 50 записей, поэтому при базе >50 клиентов портал показывает неполный список. Локальный поиск и счётчик «Найдено» работают только по этой усечённой выборке, что искажает данные и приводит к «пропавшим» клиентам.
- Итог: поиск/фильтры/пагинация не покрывают полную базу клиентов, что нарушает ожидаемое поведение CRM.

## P2 — Поиск/фильтры не используют серверные возможности
- В API `/portal/customers` есть поддержка серверного `search`, `segmentId`, `registeredOnly`, `excludeMiniapp`, но интерфейс их не использует и не предоставляет UI для фильтров (кроме строкового поиска по локальному массиву). В результате нельзя надежно фильтровать/искать по всей базе и сегментам.

## P2 — CRM-поиск по телефону требует точного совпадения и не нормализует номер
- `/portal/customer/search` принимает только `phone` и ищет точное совпадение строки. В создании/редактировании клиента номер только `trim()` без унификации формата. Это приводит к ситуациям, когда один и тот же телефон в разных форматах создаёт дубли или не находится через CRM-поиск.

## P3 — В портале нет экспорта списка клиентов
- В интерфейсе списка клиентов есть импорт, но экспорт отсутствует. Для малого бизнеса обычно нужен быстрый вывод базы в CSV/Excel (для сверок/передачи в сторонние CRM), а сейчас в портале такой функции нет.
