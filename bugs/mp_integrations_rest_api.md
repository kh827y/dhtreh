# Аудит: REST API интеграция (merchant-portal)

## Высокий приоритет

1) **Копирование/пример используют маску API-ключа вместо реального ключа после перезагрузки страницы.**
   - Страница берёт значение из `issuedKey ?? apiKeyMask`. После первой генерации ключа при следующем входе `issuedKey` пустой, поэтому в поле и в кнопке копирования оказывается только маска (`rk_****`), а не действующий ключ.
   - Это приводит к ложным успешным действиям (копирование/пример cURL), но интеграция не заработает, потому что ключ невалиден.
   - Риски: лишняя нагрузка на поддержку, ошибки интеграции у мерчантов, невозможность быстро восстановить работающий ключ без регенерации.
   - Где: `merchant-portal/app/integrations/rest-api/page.tsx` (логика `apiKeyValue`, `handleCopy`, блок cURL).

2) **Нет возможности отключить/отозвать REST API-ключ через интерфейс, хотя backend это поддерживает.**
   - В API есть `DELETE /portal/integrations/rest-api` для отключения интеграции и отзыва ключа, но на странице нет кнопки/переключателя для отключения.
   - Риск: если ключ скомпрометирован, единственный путь — регенерация (включая автоматическую активацию), нельзя “выключить” интеграцию или временно заблокировать доступ.
   - Где: UI `merchant-portal/app/integrations/rest-api/page.tsx` (отсутствует действие); backend поддерживает `api/src/portal/portal.controller.ts` + `merchant-portal/app/api/portal/integrations/rest-api/route.ts`.

## Средний приоритет

3) **Список методов на странице зашит статически и игнорирует `availableEndpoints`, которое отдаёт backend.**
   - Даже если backend обновит список доступных эндпоинтов или будет отдавать их по-разному (например, для разных конфигураций), портал продолжит показывать фиксированный список.
   - Это создает риск рассинхронизации и неверных инструкций для интеграторов.
   - Где: `merchant-portal/app/integrations/rest-api/page.tsx` (константа `endpoints`, отсутствие использования `state.availableEndpoints`).

## Низкий приоритет

4) **Ссылка на документацию не ведёт на реальный ресурс.**
   - Сейчас ссылка — `href="#"` и `alert("Переход на https://docs.api.link")`. В проде это выглядит как “пустая” кнопка и не решает задачу доступа к документации.
   - Где: `merchant-portal/app/integrations/rest-api/page.tsx` (блок «Документация»).
