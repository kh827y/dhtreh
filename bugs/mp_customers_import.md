# Аудит: импорт клиентов (merchant-portal) и /import-export/*

Ниже проблемы отсортированы по убыванию важности устранения.

## P1 — High

### 1) Глобальный API ключ для /import-export/* не ограничен мерчантом
**Риск:** любой, кто получил `API_KEY`, может экспортировать/импортировать данные любого мерчанта, просто подставив `merchantId`. Это критично для ПДн (клиенты/транзакции) и может привести к массовому компромету/подмене данных.

**Где:**
- `api/src/import-export/import-export.controller.ts` — все методы принимают `merchantId` из query/body без проверки принадлежности ключу.
- `api/src/guards/api-key.guard.ts` — ключ общий для всего API, без scoping по мерчанту.

**Почему это проблема для продакшена:** это единая «мастер‑кнопка» на доступ ко всем данным сразу, без разграничения между компаниями.

**Как исправить (без overengineering):**
- перейти на ключи, привязанные к `merchantId` (таблица интеграций/мерчант‑ключей) или
- минимально: подписывать `merchantId` отдельным секретом (HMAC) и проверять его на стороне API.

## P2 — Medium

Нет актуальных пунктов.
