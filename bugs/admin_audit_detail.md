# Аудит страницы Admin Audit Detail (/admin/audit/:id)

Ниже перечислены найденные проблемы и недоработки, отсортированные по убыванию важности.

## Medium

### 1) Экспорт CSV фактически не работает из‑за приоритета роутинга
**Где:** `api/src/admin-audit.controller.ts`, `admin/app/audit/page.tsx`

**Проблема:** в контроллере сначала объявлен `@Get(':id')`, а затем `@Get('csv')`. В Nest/Express такой порядок приводит к тому, что запрос `/admin/audit/csv` попадает в `getOne()` (id = `csv`) и возвращает `null`, а не CSV. В админке ссылка **Export CSV** ведёт именно на `/api/admin/admin/audit/csv`, поэтому экспорт недоступен.

**Риск/эффект:** невозможность выгрузки аудита для проверки/разборов инцидентов.

**Как проверить:** открыть `/admin/audit` и нажать **Export CSV** — получите пустой ответ/JSON вместо файла.

## Low

### 2) Детальная страница молча показывает пустой экран при неверном/удалённом id
**Где:** `api/src/admin-audit.controller.ts`, `admin/app/audit/[id]/page.tsx`

**Проблема:** `getOne()` возвращает `null` с кодом 200, если запись не найдена или произошла ошибка. UI не обрабатывает этот кейс (нет уведомления о 404/ошибке), поэтому пользователь видит пустую страницу без объяснения причин.

**Риск/эффект:** затрудняется диагностика проблем и поиск нужного аудита; непонятно, запись отсутствует или возникла ошибка доступа.

**Как проверить:** вручную открыть `/admin/audit/<несуществующий_id>` — страница останется пустой без сообщения.

### 3) Несогласованность API‑клиента: getAudit() обращается к несуществующему эндпоинту
**Где:** `admin/lib/audit.ts`

**Проблема:** `getAudit()` запрашивает `/admin/audit?id=...`, но в API существует только `/admin/audit/:id`. Сейчас detail‑страница обходит хелпер, но при любом использовании `getAudit()` он будет возвращать список вместо конкретной записи.

**Риск/эффект:** потенциально неверные данные в будущих доработках (например, если решат переиспользовать `getAudit()` на детальной странице).

**Как проверить:** вызвать `getAudit()` в консоли/коде — в ответ придёт список, а не одна запись.
