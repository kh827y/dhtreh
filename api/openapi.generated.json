{
  "openapi": "3.0.0",
  "paths": {
    "/healthz": {
      "get": {
        "operationId": "HealthController_health",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Health"
        ]
      }
    },
    "/readyz": {
      "get": {
        "operationId": "HealthController_ready",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Health"
        ]
      }
    },
    "/metrics": {
      "get": {
        "operationId": "MetricsController_metricsEndpoint",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Metrics"
        ]
      }
    },
    "/observability/summary": {
      "get": {
        "operationId": "AdminObservabilityController_summary",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "AdminObservability"
        ]
      }
    },
    "/alerts/state": {
      "get": {
        "operationId": "AdminObservabilityController_state",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "AdminObservability"
        ]
      }
    },
    "/alerts/test": {
      "post": {
        "operationId": "AdminObservabilityController_test",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "AdminObservability"
        ]
      }
    },
    "/loyalty/promotions": {
      "get": {
        "operationId": "LoyaltyController_listPromotions",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/promotions/claim": {
      "post": {
        "operationId": "LoyaltyController_claimPromotion",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/reviews": {
      "post": {
        "operationId": "LoyaltyController_submitReview",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/reviews/dismiss": {
      "post": {
        "operationId": "LoyaltyController_dismissReviewPrompt",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/cashier/activate": {
      "post": {
        "operationId": "LoyaltyController_cashierActivate",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    },
                    "merchantId": {
                      "type": "string"
                    },
                    "login": {
                      "type": "string"
                    },
                    "expiresAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/cashier/device": {
      "get": {
        "operationId": "LoyaltyController_cashierDevice",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "active": {
                      "type": "boolean"
                    },
                    "merchantId": {
                      "type": "string",
                      "nullable": true
                    },
                    "login": {
                      "type": "string",
                      "nullable": true
                    },
                    "expiresAt": {
                      "type": "string",
                      "format": "date-time",
                      "nullable": true
                    },
                    "lastSeenAt": {
                      "type": "string",
                      "format": "date-time",
                      "nullable": true
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      },
      "delete": {
        "operationId": "LoyaltyController_logoutCashierDevice",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/cashier/staff-access": {
      "post": {
        "operationId": "LoyaltyController_cashierStaffAccess",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "staff": {
                      "type": "object",
                      "additionalProperties": true
                    },
                    "accesses": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "additionalProperties": true
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/cashier/session": {
      "post": {
        "operationId": "LoyaltyController_startCashierSession",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    },
                    "merchantId": {
                      "type": "string"
                    },
                    "sessionId": {
                      "type": "string"
                    },
                    "staff": {
                      "type": "object",
                      "additionalProperties": true
                    },
                    "outlet": {
                      "type": "object",
                      "additionalProperties": true
                    },
                    "startedAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      },
      "get": {
        "operationId": "LoyaltyController_currentCashierSession",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "active": {
                      "type": "boolean"
                    },
                    "merchantId": {
                      "type": "string",
                      "nullable": true
                    },
                    "sessionId": {
                      "type": "string",
                      "nullable": true
                    },
                    "staff": {
                      "type": "object",
                      "nullable": true,
                      "additionalProperties": true
                    },
                    "outlet": {
                      "type": "object",
                      "nullable": true,
                      "additionalProperties": true
                    },
                    "startedAt": {
                      "type": "string",
                      "format": "date-time",
                      "nullable": true
                    },
                    "lastSeenAt": {
                      "type": "string",
                      "format": "date-time",
                      "nullable": true
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      },
      "delete": {
        "operationId": "LoyaltyController_logoutCashierSession",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/cashier/customer": {
      "post": {
        "operationId": "LoyaltyController_resolveCashierCustomer",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CashierCustomerResolveDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CashierCustomerResolveRespDto"
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/cashier/leaderboard": {
      "get": {
        "operationId": "LoyaltyController_cashierLeaderboard",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "enabled": {
                      "type": "boolean"
                    },
                    "settings": {
                      "type": "object",
                      "additionalProperties": true
                    },
                    "period": {
                      "type": "object",
                      "additionalProperties": true
                    },
                    "items": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "additionalProperties": true
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/cashier/outlet-transactions": {
      "get": {
        "operationId": "LoyaltyController_cashierOutletTransactions",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CashierOutletTransactionsRespDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/qr": {
      "post": {
        "operationId": "LoyaltyController_mintQr",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/QrMintDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QrMintRespDto"
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/quote": {
      "post": {
        "operationId": "LoyaltyController_quote",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/QuoteDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/QuoteRedeemRespDto"
                    },
                    {
                      "$ref": "#/components/schemas/QuoteEarnRespDto"
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/commit": {
      "post": {
        "operationId": "LoyaltyController_commit",
        "parameters": [
          {
            "name": "Idempotency-Key",
            "in": "header",
            "description": "Идемпотентность COMMIT",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CommitDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommitRespDto"
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/cancel": {
      "post": {
        "operationId": "LoyaltyController_cancel",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/balance/{merchantId}/{customerId}": {
      "get": {
        "operationId": "LoyaltyController_balance2",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BalanceDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/settings/{merchantId}": {
      "get": {
        "operationId": "LoyaltyController_publicSettings",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicSettingsDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/promocodes/apply": {
      "post": {
        "operationId": "LoyaltyController_applyPromoCode",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    },
                    "promoCodeId": {
                      "type": "string"
                    },
                    "code": {
                      "type": "string"
                    },
                    "pointsIssued": {
                      "type": "number"
                    },
                    "pointsExpireInDays": {
                      "type": "number",
                      "nullable": true
                    },
                    "pointsExpireAt": {
                      "type": "string",
                      "format": "date-time",
                      "nullable": true
                    },
                    "balance": {
                      "type": "number"
                    },
                    "tierAssigned": {
                      "type": "string",
                      "nullable": true
                    },
                    "message": {
                      "type": "string",
                      "nullable": true
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/refund": {
      "post": {
        "operationId": "LoyaltyController_refund",
        "parameters": [
          {
            "name": "Idempotency-Key",
            "in": "header",
            "description": "Идемпотентность REFUND",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RefundDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RefundRespDto"
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/teleauth": {
      "post": {
        "operationId": "LoyaltyController_teleauth",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/profile": {
      "get": {
        "operationId": "LoyaltyController_getProfile",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomerProfileDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      },
      "post": {
        "operationId": "LoyaltyController_saveProfile",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CustomerProfileSaveDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomerProfileDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/profile/phone-status": {
      "get": {
        "operationId": "LoyaltyController_getProfilePhoneStatus",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomerPhoneStatusDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/transactions": {
      "get": {
        "operationId": "LoyaltyController_transactions",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "staffId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TransactionsRespDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/outlets/{merchantId}": {
      "get": {
        "operationId": "LoyaltyController_publicOutlets",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/PublicOutletDto"
                  }
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/staff/{merchantId}": {
      "get": {
        "operationId": "LoyaltyController_publicStaff",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/PublicStaffDto"
                  }
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/consent": {
      "get": {
        "operationId": "LoyaltyController_getConsent",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConsentGetRespDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      },
      "post": {
        "operationId": "LoyaltyController_setConsent",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/bootstrap": {
      "get": {
        "operationId": "LoyaltyController_bootstrap",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "transactionsLimit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "loyalty"
        ]
      }
    },
    "/loyalty/mechanics/levels/{merchantId}": {
      "get": {
        "operationId": "LoyaltyPublicController_mechanicsLevels",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "merchantId": {
                      "type": "string"
                    },
                    "levels": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "additionalProperties": true
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "loyalty-public"
        ]
      }
    },
    "/loyalty/mechanics/registration-bonus": {
      "post": {
        "operationId": "LoyaltyPublicController_grantRegistrationBonus",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "loyalty-public"
        ]
      }
    },
    "/loyalty/events/poll": {
      "get": {
        "operationId": "LoyaltyPublicController_pollEvents",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "loyalty-public"
        ]
      }
    },
    "/subscription/plans": {
      "get": {
        "operationId": "SubscriptionController_getPlans",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Список планов"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить список доступных планов",
        "tags": [
          "Subscriptions"
        ]
      }
    },
    "/subscription/create": {
      "post": {
        "operationId": "SubscriptionController_createSubscription",
        "parameters": [],
        "responses": {
          "201": {
            "description": "Подписка создана"
          },
          "400": {
            "description": "Неверные данные"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Создать новую подписку",
        "tags": [
          "Subscriptions"
        ]
      }
    },
    "/subscription/{merchantId}": {
      "get": {
        "operationId": "SubscriptionController_getSubscription",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Информация о подписке"
          },
          "404": {
            "description": "Подписка не найдена"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить информацию о подписке",
        "tags": [
          "Subscriptions"
        ]
      },
      "put": {
        "operationId": "SubscriptionController_updateSubscription",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Подписка обновлена"
          },
          "404": {
            "description": "Подписка не найдена"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Обновить подписку",
        "tags": [
          "Subscriptions"
        ]
      },
      "delete": {
        "operationId": "SubscriptionController_cancelSubscription",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "immediately",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Подписка отменена"
          },
          "404": {
            "description": "Подписка не найдена"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Отменить подписку",
        "tags": [
          "Subscriptions"
        ]
      }
    },
    "/subscription/{merchantId}/feature/{feature}": {
      "get": {
        "operationId": "SubscriptionController_checkFeature",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "feature",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Статус доступности"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Проверить доступность функции для плана",
        "tags": [
          "Subscriptions"
        ]
      }
    },
    "/subscription/{merchantId}/usage": {
      "get": {
        "operationId": "SubscriptionController_getUsageStatistics",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Статистика использования"
          },
          "404": {
            "description": "Подписка не найдена"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить статистику использования лимитов",
        "tags": [
          "Subscriptions"
        ]
      }
    },
    "/subscription/{merchantId}/validate-limits": {
      "post": {
        "operationId": "SubscriptionController_validatePlanLimits",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Лимиты соблюдены"
          },
          "400": {
            "description": "Превышены лимиты плана"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Проверить соответствие текущего использования лимитам плана",
        "tags": [
          "Subscriptions"
        ]
      }
    },
    "/push/device/register": {
      "post": {
        "operationId": "PushController_registerDevice",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Устройство зарегистрировано"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Регистрация устройства для push-уведомлений",
        "tags": [
          "Push Notifications"
        ]
      }
    },
    "/push/send": {
      "post": {
        "operationId": "PushController_sendPush",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Уведомление отправлено"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Отправить push-уведомление",
        "tags": [
          "Push Notifications"
        ]
      }
    },
    "/push/topic/{merchantId}": {
      "post": {
        "operationId": "PushController_sendToTopic",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Уведомление отправлено"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Отправить уведомление всем подписчикам мерчанта",
        "tags": [
          "Push Notifications"
        ]
      }
    },
    "/push/device/{outletId}": {
      "delete": {
        "operationId": "PushController_deactivateDevice",
        "parameters": [
          {
            "name": "outletId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Устройство деактивировано"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Деактивировать устройство",
        "tags": [
          "Push Notifications"
        ]
      }
    },
    "/push/stats/{merchantId}": {
      "get": {
        "operationId": "PushController_getPushStats",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Статистика push"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить статистику push-уведомлений",
        "tags": [
          "Push Notifications"
        ]
      }
    },
    "/push/templates": {
      "get": {
        "operationId": "PushController_getPushTemplates",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Список шаблонов"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить готовые шаблоны push-уведомлений",
        "tags": [
          "Push Notifications"
        ]
      }
    },
    "/push/test/{customerId}": {
      "post": {
        "operationId": "PushController_sendTestPush",
        "parameters": [
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Тестовое уведомление отправлено"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Отправить тестовое push-уведомление",
        "tags": [
          "Push Notifications"
        ]
      }
    },
    "/email/send": {
      "post": {
        "operationId": "EmailController_sendEmail",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Email отправлен"
          },
          "400": {
            "description": "Ошибка отправки"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Отправить email уведомление",
        "tags": [
          "Email Notifications"
        ]
      }
    },
    "/email/welcome": {
      "post": {
        "operationId": "EmailController_sendWelcomeEmail",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Отправить приветственное письмо новому клиенту",
        "tags": [
          "Email Notifications"
        ]
      }
    },
    "/email/transaction/{transactionId}": {
      "post": {
        "operationId": "EmailController_sendTransactionEmail",
        "parameters": [
          {
            "name": "transactionId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Отправить email о транзакции",
        "tags": [
          "Email Notifications"
        ]
      }
    },
    "/email/campaign": {
      "post": {
        "operationId": "EmailController_sendCampaignEmail",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Отправить массовую рассылку по кампании",
        "tags": [
          "Email Notifications"
        ]
      }
    },
    "/email/report": {
      "post": {
        "operationId": "EmailController_sendReportEmail",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Отправить отчет на email",
        "tags": [
          "Email Notifications"
        ]
      }
    },
    "/email/reminder/{customerId}": {
      "post": {
        "operationId": "EmailController_sendPointsReminder",
        "parameters": [
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Отправить напоминание о неиспользованных баллах",
        "tags": [
          "Email Notifications"
        ]
      }
    },
    "/email/templates": {
      "get": {
        "operationId": "EmailController_getEmailTemplates",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Список шаблонов"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить список шаблонов email",
        "tags": [
          "Email Notifications"
        ]
      }
    },
    "/email/test": {
      "post": {
        "operationId": "EmailController_sendTestEmail",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Отправить тестовое письмо",
        "tags": [
          "Email Notifications"
        ]
      }
    },
    "/notifications/broadcast": {
      "post": {
        "operationId": "NotificationsController_broadcast",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "notifications"
        ]
      }
    },
    "/notifications/test": {
      "post": {
        "operationId": "NotificationsController_test",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "notifications"
        ]
      }
    },
    "/telegram/webhook/{merchantId}": {
      "post": {
        "operationId": "TelegramController_webhook",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Telegram"
        ]
      }
    },
    "/merchants/{id}/telegram/register": {
      "post": {
        "operationId": "TelegramController_register",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Telegram"
        ]
      }
    },
    "/merchants/{id}/telegram/rotate-webhook": {
      "post": {
        "operationId": "TelegramController_rotateWebhook",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Telegram"
        ]
      }
    },
    "/merchants/{id}/telegram": {
      "delete": {
        "operationId": "TelegramController_deactivate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Telegram"
        ]
      }
    },
    "/telegram/notify/webhook": {
      "post": {
        "operationId": "TelegramNotifyController_webhook",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "TelegramNotify"
        ]
      }
    },
    "/telegram/notify/webhook-info": {
      "get": {
        "operationId": "TelegramNotifyController_webhookInfo",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "TelegramNotify"
        ]
      }
    },
    "/antifraud/check": {
      "post": {
        "operationId": "AntifraudController_checkFraud",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Fraud check result"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Check fraud risk for a transaction",
        "tags": [
          "Antifraud"
        ]
      }
    },
    "/antifraud/history/{customerId}": {
      "get": {
        "operationId": "AntifraudController_getFraudHistory",
        "parameters": [
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Fraud check history"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get fraud check history for a customer",
        "tags": [
          "Antifraud"
        ]
      }
    },
    "/antifraud/{checkId}/review": {
      "post": {
        "operationId": "AntifraudController_reviewFraudCheck",
        "parameters": [
          {
            "name": "checkId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Review recorded"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Review a fraud check",
        "tags": [
          "Antifraud"
        ]
      }
    },
    "/antifraud/stats": {
      "get": {
        "operationId": "AntifraudController_getFraudStats",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Fraud statistics"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get fraud statistics",
        "tags": [
          "Antifraud"
        ]
      }
    },
    "/merchants": {
      "get": {
        "operationId": "MerchantsController_listMerchants",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string"
                      },
                      "initialName": {
                        "type": "string"
                      },
                      "createdAt": {
                        "type": "string"
                      },
                      "portalEmail": {
                        "type": "string",
                        "nullable": true
                      },
                      "portalLoginEnabled": {
                        "type": "boolean"
                      },
                      "portalTotpEnabled": {
                        "type": "boolean"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      },
      "post": {
        "operationId": "MerchantsController_createMerchant",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "name": {
                      "type": "string"
                    },
                    "initialName": {
                      "type": "string"
                    },
                    "email": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}": {
      "put": {
        "operationId": "MerchantsController_updateMerchant",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "name": {
                      "type": "string"
                    },
                    "initialName": {
                      "type": "string"
                    },
                    "email": {
                      "type": "string",
                      "nullable": true
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      },
      "delete": {
        "operationId": "MerchantsController_deleteMerchant",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/subscription": {
      "post": {
        "operationId": "MerchantsController_grantSubscription",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "merchants"
        ]
      },
      "delete": {
        "operationId": "MerchantsController_resetSubscription",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/settings": {
      "get": {
        "operationId": "MerchantsController_getSettings",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MerchantSettingsRespDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      },
      "put": {
        "operationId": "MerchantsController_updateSettings",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateMerchantSettingsDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MerchantSettingsRespDto"
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/rules/preview": {
      "get": {
        "operationId": "MerchantsController_previewRules",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "channel",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "weekday",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "category",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "earnBps": {
                      "type": "number"
                    },
                    "redeemLimitBps": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outlets": {
      "get": {
        "operationId": "MerchantsController_listOutlets",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/OutletDto"
                  }
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      },
      "post": {
        "operationId": "MerchantsController_createOutlet",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateOutletDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutletDto"
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outlets/{outletId}": {
      "put": {
        "operationId": "MerchantsController_updateOutlet",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateOutletDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutletDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      },
      "delete": {
        "operationId": "MerchantsController_deleteOutlet",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outlets/{outletId}/pos": {
      "put": {
        "operationId": "MerchantsController_updateOutletPos",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateOutletPosDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutletDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outlets/{outletId}/status": {
      "put": {
        "operationId": "MerchantsController_updateOutletStatus",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateOutletStatusDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutletDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/staff": {
      "get": {
        "operationId": "MerchantsController_listStaff",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/StaffDto"
                  }
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      },
      "post": {
        "operationId": "MerchantsController_createStaff",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateStaffDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StaffDto"
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/staff/{staffId}": {
      "put": {
        "operationId": "MerchantsController_updateStaff",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "staffId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateStaffDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StaffDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      },
      "delete": {
        "operationId": "MerchantsController_deleteStaff",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "staffId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/staff/{staffId}/token": {
      "post": {
        "operationId": "MerchantsController_issueStaffToken",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "staffId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenRespDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      },
      "delete": {
        "operationId": "MerchantsController_revokeStaffToken",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "staffId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outbox": {
      "get": {
        "operationId": "MerchantsController_listOutbox",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "status",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "type",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "since",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/OutboxEventDto"
                  }
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outbox/{eventId}/retry": {
      "post": {
        "operationId": "MerchantsController_retryOutbox",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "eventId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outbox/{eventId}": {
      "delete": {
        "operationId": "MerchantsController_deleteOutbox",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "eventId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outbox/retryAll": {
      "post": {
        "operationId": "MerchantsController_retryAll",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "status",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkUpdateRespDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outbox/event/{eventId}": {
      "get": {
        "operationId": "MerchantsController_getOutboxEvent",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "eventId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutboxEventDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outbox/retrySince": {
      "post": {
        "operationId": "MerchantsController_retrySince",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkUpdateRespDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outbox/pause": {
      "post": {
        "operationId": "MerchantsController_pauseOutbox",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outbox/resume": {
      "post": {
        "operationId": "MerchantsController_resumeOutbox",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outbox/stats": {
      "get": {
        "operationId": "MerchantsController_outboxStats",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "since",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "merchantId": {
                      "type": "string"
                    },
                    "since": {
                      "type": "string",
                      "nullable": true
                    },
                    "counts": {
                      "type": "object",
                      "additionalProperties": {
                        "type": "number"
                      }
                    },
                    "lastDeadAt": {
                      "type": "string",
                      "nullable": true
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outbox.csv": {
      "get": {
        "operationId": "MerchantsController_outboxCsv",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "status",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "since",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "type",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "batch",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "CSV (streamed)"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/portal/rotate-key": {
      "post": {
        "operationId": "MerchantsController_rotatePortalKey",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "key": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/portal/login-enabled": {
      "post": {
        "operationId": "MerchantsController_setPortalLoginEnabled",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/portal/totp/init": {
      "post": {
        "operationId": "MerchantsController_initTotp",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "secret": {
                      "type": "string"
                    },
                    "otpauth": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/portal/totp/verify": {
      "post": {
        "operationId": "MerchantsController_verifyTotp",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/portal/totp/disable": {
      "post": {
        "operationId": "MerchantsController_disableTotp",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/portal/impersonate": {
      "post": {
        "operationId": "MerchantsController_impersonatePortal",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenRespDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/cashier": {
      "get": {
        "operationId": "MerchantsController_getCashier",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "login": {
                      "type": "string",
                      "nullable": true
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/cashier/rotate": {
      "post": {
        "operationId": "MerchantsController_rotateCashier",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "login": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/outbox/by-order": {
      "get": {
        "operationId": "MerchantsController_outboxByOrder",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "orderId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/OutboxEventDto"
                  }
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/transactions": {
      "get": {
        "operationId": "MerchantsController_listTransactions",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "type",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "staffId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/TransactionItemDto"
                  }
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/receipts": {
      "get": {
        "operationId": "MerchantsController_listReceipts",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "orderId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ReceiptDto"
                  }
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/receipts/{receiptId}": {
      "get": {
        "operationId": "MerchantsController_getReceipt",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "receiptId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "receipt": {
                      "$ref": "#/components/schemas/ReceiptDto"
                    },
                    "transactions": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/TransactionItemDto"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/receipts.csv": {
      "get": {
        "operationId": "MerchantsController_exportReceiptsCsv",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "batch",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "orderId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "CSV (streamed)"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/ledger": {
      "get": {
        "operationId": "MerchantsController_listLedger",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "type",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/LedgerEntryDto"
                  }
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/ledger.csv": {
      "get": {
        "operationId": "MerchantsController_exportLedgerCsv",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "batch",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "type",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "CSV (streamed)"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/ttl/reconciliation": {
      "get": {
        "operationId": "MerchantsController_ttlReconciliation",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "cutoff",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "merchantId": {
                      "type": "string"
                    },
                    "cutoff": {
                      "type": "string"
                    },
                    "items": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "customerId": {
                            "type": "string"
                          },
                          "expiredRemain": {
                            "type": "number"
                          },
                          "burned": {
                            "type": "number"
                          },
                          "diff": {
                            "type": "number"
                          }
                        }
                      }
                    },
                    "totals": {
                      "type": "object",
                      "properties": {
                        "expiredRemain": {
                          "type": "number"
                        },
                        "burned": {
                          "type": "number"
                        },
                        "diff": {
                          "type": "number"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/ttl/reconciliation.csv": {
      "get": {
        "operationId": "MerchantsController_exportTtlReconciliationCsv",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "cutoff",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "onlyDiff",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "CSV"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/customer/search": {
      "get": {
        "operationId": "MerchantsController_customerSearch",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "phone",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/CustomerSearchRespDto"
                    },
                    {
                      "type": "null"
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/merchants/{id}/transactions.csv": {
      "get": {
        "operationId": "MerchantsController_exportTxCsv",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ (в проде проксируется сервером админки)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "batch",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "type",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "staffId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "CSV (streamed)"
                }
              }
            }
          }
        },
        "tags": [
          "merchants"
        ]
      }
    },
    "/levels/{merchantId}/{customerId}": {
      "get": {
        "operationId": "LevelsController_current",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "merchantId": {
                      "type": "string"
                    },
                    "customerId": {
                      "type": "string"
                    },
                    "metric": {
                      "type": "string",
                      "enum": [
                        "earn",
                        "redeem",
                        "transactions"
                      ]
                    },
                    "periodDays": {
                      "type": "number"
                    },
                    "value": {
                      "type": "number"
                    },
                    "current": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string"
                        },
                        "threshold": {
                          "type": "number"
                        },
                        "earnRateBps": {
                          "type": "number",
                          "nullable": true
                        },
                        "redeemRateBps": {
                          "type": "number",
                          "nullable": true
                        },
                        "minPaymentAmount": {
                          "type": "number",
                          "nullable": true
                        },
                        "isHidden": {
                          "type": "boolean",
                          "nullable": true
                        }
                      }
                    },
                    "next": {
                      "type": "object",
                      "nullable": true,
                      "properties": {
                        "name": {
                          "type": "string"
                        },
                        "threshold": {
                          "type": "number"
                        },
                        "earnRateBps": {
                          "type": "number",
                          "nullable": true
                        },
                        "redeemRateBps": {
                          "type": "number",
                          "nullable": true
                        },
                        "minPaymentAmount": {
                          "type": "number",
                          "nullable": true
                        },
                        "isHidden": {
                          "type": "boolean",
                          "nullable": true
                        }
                      }
                    },
                    "progressToNext": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "levels"
        ]
      }
    },
    "/analytics/dashboard/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getDashboard",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": false,
            "in": "query",
            "description": "ISO date string",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": false,
            "in": "query",
            "description": "ISO date string",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Дашборд с метриками"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить полную аналитику для владельца бизнеса",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/portrait/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getCustomerPortrait",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "segmentId",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Портрет клиента: пол, возраст, пол×возраст",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/repeat/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getRepeatPurchases",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Повторные покупки и распределение покупок",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/birthdays/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getBirthdays",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "withinDays",
            "required": false,
            "in": "query",
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Список ближайших дней рождения клиентов мерчанта",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/referral/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getReferralSummary",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Сводка реферальной программы за период",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/business/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getBusinessMetrics",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "minPurchases",
            "required": false,
            "in": "query",
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Бизнес‑метрики: средний чек покупателей с N+ покупок",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/revenue/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getRevenueMetrics",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "group",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "day",
                "week",
                "month"
              ],
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить метрики выручки",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/customers/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getCustomerMetrics",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить метрики клиентов",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/loyalty/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getLoyaltyMetrics",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "group",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "day",
                "week",
                "month"
              ],
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить метрики программы лояльности",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/auto-return/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getAutoReturnMetrics",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Статистика механики автовозврата клиентов",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/birthday-mechanic/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getBirthdayMechanicMetrics",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Статистика механики поздравлений с днём рождения",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/campaigns/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getCampaignMetrics",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить метрики маркетинговых кампаний",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/time/recency/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getRecencyDistribution",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "group",
            "required": false,
            "in": "query",
            "description": "Группировка: day | week | month (по умолчанию day)",
            "schema": {
              "enum": [
                "day",
                "week",
                "month"
              ],
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Количество отображаемых интервалов (в пределах допустимого)",
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Распределение клиентов по давности последней покупки",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/time/activity/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getTimeActivity",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Активность клиентов по дням недели, часам и тепловая карта",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/cohorts/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getRetentionCohorts",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "by",
            "required": false,
            "in": "query",
            "description": "Группировка когорт: month|week (по умолчанию month)",
            "schema": {
              "enum": [
                "month",
                "week"
              ],
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Количество когорт, по умолчанию 6",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Когорты удержания по месяцам/неделям (как в GetMeBack)",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/operations/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getOperationalMetrics",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "required": false,
            "in": "query",
            "schema": {
              "enum": [
                "yesterday",
                "day",
                "week",
                "month",
                "quarter",
                "year"
              ],
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить операционные метрики (точки, персонал, устройства)",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/reports/templates": {
      "get": {
        "operationId": "AnalyticsController_getReportTemplates",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Список шаблонов"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить список готовых шаблонов отчетов",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/analytics/widgets/{merchantId}": {
      "get": {
        "operationId": "AnalyticsController_getWidgetData",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Данные виджетов"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить данные для виджетов дашборда",
        "tags": [
          "Analytics"
        ]
      }
    },
    "/admin/audit": {
      "get": {
        "operationId": "AdminAuditController_list",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "AdminAudit"
        ]
      }
    },
    "/admin/audit/csv": {
      "get": {
        "operationId": "AdminAuditController_exportCsv",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "AdminAudit"
        ]
      }
    },
    "/admin/audit/{id}": {
      "get": {
        "operationId": "AdminAuditController_getOne",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "AdminAudit"
        ]
      }
    },
    "/crm/{merchantId}/customer/{customerId}/card": {
      "get": {
        "operationId": "CrmController_getCustomerCard",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Карточка клиента с балансом, RFM и последними операциями"
          }
        },
        "tags": [
          "crm"
        ]
      }
    },
    "/crm/{merchantId}/customer/search": {
      "get": {
        "operationId": "CrmController_searchCustomer",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "phone",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "email",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Поиск клиента по id/телефону/email с краткой сводкой"
          }
        },
        "tags": [
          "crm"
        ]
      }
    },
    "/crm/{merchantId}/rfm/distribution": {
      "get": {
        "operationId": "CrmController_rfmDistribution",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Распределение клиентов по классам RFM"
          }
        },
        "tags": [
          "crm"
        ]
      }
    },
    "/crm/{merchantId}/segments/{segmentId}/customers": {
      "get": {
        "operationId": "CrmController_listSegmentCustomers",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "segmentId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "cursor",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Список клиентов сегмента (пагинация по cursor)"
          }
        },
        "tags": [
          "crm"
        ]
      }
    },
    "/crm/{merchantId}/segments/{segmentId}/customers.csv": {
      "get": {
        "operationId": "CrmController_exportSegmentCustomersCsv",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "segmentId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "batch",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Экспорт клиентов сегмента в CSV (стрим)"
          }
        },
        "tags": [
          "crm"
        ]
      }
    },
    "/crm/{merchantId}/customer/{customerId}/timeline": {
      "get": {
        "operationId": "CrmController_getCustomerTimeline",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "description": "Админ-ключ",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Таймлайн клиента (последние события)"
          }
        },
        "tags": [
          "crm"
        ]
      }
    },
    "/gifts/{merchantId}": {
      "get": {
        "operationId": "GiftsController_list",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Список доступных подарков"
          }
        },
        "tags": [
          "gifts"
        ]
      }
    },
    "/gifts": {
      "post": {
        "operationId": "GiftsController_create",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Function"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "gifts"
        ]
      }
    },
    "/gifts/{giftId}": {
      "put": {
        "operationId": "GiftsController_update",
        "parameters": [
          {
            "name": "giftId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-Admin-Key",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Function"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "gifts"
        ]
      }
    },
    "/gifts/{merchantId}/{giftId}/redeem": {
      "post": {
        "operationId": "GiftsController_redeem",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "giftId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "gifts"
        ]
      }
    },
    "/referral/program": {
      "post": {
        "operationId": "ReferralController_createProgram",
        "parameters": [],
        "responses": {
          "201": {
            "description": "Программа создана"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Создать новую реферальную программу",
        "tags": [
          "Referral Program"
        ]
      }
    },
    "/referral/program/{merchantId}": {
      "get": {
        "operationId": "ReferralController_getProgram",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить активную реферальную программу мерчанта",
        "tags": [
          "Referral Program"
        ]
      }
    },
    "/referral/program/{programId}": {
      "put": {
        "operationId": "ReferralController_updateProgram",
        "parameters": [
          {
            "name": "programId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Обновить реферальную программу",
        "tags": [
          "Referral Program"
        ]
      }
    },
    "/referral/activate": {
      "post": {
        "operationId": "ReferralController_activateReferral",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Активировать реферальный код при регистрации",
        "tags": [
          "Referral Program"
        ]
      }
    },
    "/referral/complete": {
      "post": {
        "operationId": "ReferralController_completeReferral",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Завершить реферал после первой покупки",
        "tags": [
          "Referral Program"
        ]
      }
    },
    "/referral/stats/{merchantId}": {
      "get": {
        "operationId": "ReferralController_getStats",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "programId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить статистику реферальной программы",
        "tags": [
          "Referral Program"
        ]
      }
    },
    "/referral/customer/{customerId}": {
      "get": {
        "operationId": "ReferralController_getCustomerReferrals",
        "parameters": [
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить список рефералов клиента",
        "tags": [
          "Referral Program"
        ]
      }
    },
    "/referral/link/{customerId}": {
      "get": {
        "operationId": "ReferralController_getCustomerLink",
        "parameters": [
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить персональную реферальную ссылку клиента",
        "tags": [
          "Referral Program"
        ]
      }
    },
    "/referral/leaderboard/{merchantId}": {
      "get": {
        "operationId": "ReferralController_getLeaderboard",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить топ приглашающих клиентов",
        "tags": [
          "Referral Program"
        ]
      }
    },
    "/portal/auth/login": {
      "post": {
        "operationId": "PortalAuthController_login",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "token": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request"
          },
          "401": {
            "description": "Invalid credentials"
          }
        },
        "tags": [
          "portal-auth"
        ]
      }
    },
    "/portal/auth/refresh": {
      "post": {
        "operationId": "PortalAuthController_refresh",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "token": {
                      "type": "string"
                    },
                    "refreshToken": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request"
          },
          "401": {
            "description": "Invalid refresh"
          }
        },
        "tags": [
          "portal-auth"
        ]
      }
    },
    "/portal/auth/me": {
      "get": {
        "operationId": "PortalAuthController_me",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "merchantId": {
                      "type": "string"
                    },
                    "role": {
                      "type": "string"
                    },
                    "actor": {
                      "type": "string"
                    },
                    "staffId": {
                      "type": "string",
                      "nullable": true
                    },
                    "adminImpersonation": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": ""
          }
        },
        "tags": [
          "portal-auth"
        ]
      }
    },
    "/portal/subscription": {
      "get": {
        "operationId": "PortalController_subscription",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/reviews": {
      "get": {
        "operationId": "PortalController_listReviews",
        "parameters": [
          {
            "name": "withCommentOnly",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "staffId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "deviceId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "offset",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/me": {
      "get": {
        "operationId": "PortalController_me",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "merchantId": {
                      "type": "string"
                    },
                    "role": {
                      "type": "string"
                    },
                    "actor": {
                      "type": "string"
                    },
                    "adminImpersonation": {
                      "type": "boolean"
                    },
                    "staff": {
                      "type": "object",
                      "nullable": true,
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string",
                          "nullable": true
                        },
                        "email": {
                          "type": "string",
                          "nullable": true
                        },
                        "role": {
                          "type": "string",
                          "nullable": true
                        },
                        "groups": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "name": {
                                "type": "string"
                              },
                              "scope": {
                                "type": "string"
                              }
                            }
                          }
                        }
                      }
                    },
                    "permissions": {
                      "type": "object",
                      "additionalProperties": {
                        "type": "array",
                        "items": {
                          "type": "string"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/customer/search": {
      "get": {
        "operationId": "PortalController_customerSearch",
        "parameters": [
          {
            "name": "phone",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "type": "object",
                      "properties": {
                        "customerId": {
                          "type": "string"
                        },
                        "phone": {
                          "type": "string",
                          "nullable": true
                        },
                        "balance": {
                          "type": "number"
                        }
                      }
                    },
                    {
                      "type": "null"
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/customers": {
      "get": {
        "operationId": "PortalController_listCustomers",
        "parameters": [
          {
            "name": "search",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "offset",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "segmentId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "registeredOnly",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "excludeMiniapp",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": true
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "post": {
        "operationId": "PortalController_createCustomer",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/customers/{customerId}": {
      "get": {
        "operationId": "PortalController_getCustomer",
        "parameters": [
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "put": {
        "operationId": "PortalController_updateCustomer",
        "parameters": [
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "delete": {
        "operationId": "PortalController_deleteCustomer",
        "parameters": [
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/customers/import": {
      "post": {
        "operationId": "PortalController_importCustomers",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/customers/{customerId}/transactions/accrual": {
      "post": {
        "operationId": "PortalController_manualAccrual",
        "parameters": [
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/customers/{customerId}/transactions/redeem": {
      "post": {
        "operationId": "PortalController_manualRedeem",
        "parameters": [
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/customers/{customerId}/transactions/complimentary": {
      "post": {
        "operationId": "PortalController_manualComplimentary",
        "parameters": [
          {
            "name": "customerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/promocodes": {
      "get": {
        "operationId": "PortalController_promocodesList",
        "parameters": [
          {
            "name": "status",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "offset",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "items": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "additionalProperties": true
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/promocodes/issue": {
      "post": {
        "operationId": "PortalController_promocodesIssue",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    },
                    "promoCodeId": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/promocodes/deactivate": {
      "post": {
        "operationId": "PortalController_promocodesDeactivate",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/promocodes/activate": {
      "post": {
        "operationId": "PortalController_promocodesActivate",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/promocodes/{promoCodeId}": {
      "put": {
        "operationId": "PortalController_promocodesUpdate",
        "parameters": [
          {
            "name": "promoCodeId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/loyalty/ttl/forecast": {
      "get": {
        "operationId": "PortalController_ttlReminderForecast",
        "parameters": [
          {
            "name": "daysBefore",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "count": {
                      "type": "number"
                    },
                    "daysBefore": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/notifications/broadcast": {
      "post": {
        "operationId": "PortalController_notificationsBroadcast",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    },
                    "dryRun": {
                      "type": "boolean",
                      "nullable": true
                    },
                    "estimated": {
                      "type": "number",
                      "nullable": true
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/push-campaigns": {
      "get": {
        "operationId": "PortalController_listPushCampaigns",
        "parameters": [
          {
            "name": "scope",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": true
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "post": {
        "operationId": "PortalController_createPushCampaign",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/push-campaigns/{campaignId}/cancel": {
      "post": {
        "operationId": "PortalController_cancelPushCampaign",
        "parameters": [
          {
            "name": "campaignId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/push-campaigns/{campaignId}/archive": {
      "post": {
        "operationId": "PortalController_archivePushCampaign",
        "parameters": [
          {
            "name": "campaignId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/push-campaigns/{campaignId}/duplicate": {
      "post": {
        "operationId": "PortalController_duplicatePushCampaign",
        "parameters": [
          {
            "name": "campaignId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/telegram-campaigns": {
      "get": {
        "operationId": "PortalController_listTelegramCampaigns",
        "parameters": [
          {
            "name": "scope",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": true
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "post": {
        "operationId": "PortalController_createTelegramCampaign",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/telegram-campaigns/{campaignId}/cancel": {
      "post": {
        "operationId": "PortalController_cancelTelegramCampaign",
        "parameters": [
          {
            "name": "campaignId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/telegram-campaigns/{campaignId}/archive": {
      "post": {
        "operationId": "PortalController_archiveTelegramCampaign",
        "parameters": [
          {
            "name": "campaignId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/telegram-campaigns/{campaignId}/duplicate": {
      "post": {
        "operationId": "PortalController_duplicateTelegramCampaign",
        "parameters": [
          {
            "name": "campaignId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/staff-motivation": {
      "get": {
        "operationId": "PortalController_getStaffMotivation",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "enabled": {
                      "type": "boolean"
                    },
                    "pointsForNewCustomer": {
                      "type": "number"
                    },
                    "pointsForExistingCustomer": {
                      "type": "number"
                    },
                    "leaderboardPeriod": {
                      "type": "string"
                    },
                    "customDays": {
                      "type": "number",
                      "nullable": true
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "put": {
        "operationId": "PortalController_updateStaffMotivation",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/referrals/program": {
      "get": {
        "operationId": "PortalController_referralProgramSettings",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      },
      "put": {
        "operationId": "PortalController_updateReferralProgramSettings",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/operations/log": {
      "get": {
        "operationId": "PortalController_getOperationsLog",
        "parameters": [
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "staffId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "staffStatus",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "deviceId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "direction",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "receiptNumber",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "operationType",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "carrier",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "offset",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "total": {
                      "type": "number"
                    },
                    "items": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "additionalProperties": true
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/operations/log/{receiptId}": {
      "get": {
        "operationId": "PortalController_getOperationDetails",
        "parameters": [
          {
            "name": "receiptId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/operations/log/{receiptId}/cancel": {
      "post": {
        "operationId": "PortalController_cancelOperation",
        "parameters": [
          {
            "name": "receiptId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/dashboard": {
      "get": {
        "operationId": "PortalController_dashboard",
        "parameters": [
          {
            "name": "period",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/portrait": {
      "get": {
        "operationId": "PortalController_portrait",
        "parameters": [
          {
            "name": "period",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "segmentId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/repeat": {
      "get": {
        "operationId": "PortalController_repeat",
        "parameters": [
          {
            "name": "period",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/birthdays": {
      "get": {
        "operationId": "PortalController_birthdays",
        "parameters": [
          {
            "name": "withinDays",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/referral": {
      "get": {
        "operationId": "PortalController_referral",
        "parameters": [
          {
            "name": "period",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/referral/leaderboard": {
      "get": {
        "operationId": "PortalController_referralLeaderboard",
        "parameters": [
          {
            "name": "period",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "offset",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/operations": {
      "get": {
        "operationId": "PortalController_analyticsOperations",
        "parameters": [
          {
            "name": "period",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/revenue": {
      "get": {
        "operationId": "PortalController_revenue",
        "parameters": [
          {
            "name": "period",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "group",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/customers": {
      "get": {
        "operationId": "PortalController_customers",
        "parameters": [
          {
            "name": "period",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/auto-return": {
      "get": {
        "operationId": "PortalController_analyticsAutoReturn",
        "parameters": [
          {
            "name": "period",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/birthday-mechanic": {
      "get": {
        "operationId": "PortalController_analyticsBirthdayMechanic",
        "parameters": [
          {
            "name": "period",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/time/recency": {
      "get": {
        "operationId": "PortalController_analyticsTimeRecency",
        "parameters": [
          {
            "name": "group",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/time/activity": {
      "get": {
        "operationId": "PortalController_analyticsTimeActivity",
        "parameters": [
          {
            "name": "period",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/loyalty": {
      "get": {
        "operationId": "PortalController_loyalty",
        "parameters": [
          {
            "name": "period",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "group",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/cohorts": {
      "get": {
        "operationId": "PortalController_cohorts",
        "parameters": [
          {
            "name": "by",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/rfm": {
      "get": {
        "operationId": "PortalController_rfmAnalytics",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/analytics/rfm/settings": {
      "put": {
        "operationId": "PortalController_updateRfmAnalyticsSettings",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateRfmSettingsDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/integrations": {
      "get": {
        "operationId": "PortalController_integrations",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "type": {
                        "type": "string"
                      },
                      "provider": {
                        "type": "string"
                      },
                      "isActive": {
                        "type": "boolean"
                      },
                      "lastSync": {
                        "type": "string",
                        "nullable": true
                      },
                      "errorCount": {
                        "type": "number"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/integrations/rest-api": {
      "get": {
        "operationId": "PortalController_restApiIntegrationState",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "enabled": {
                      "type": "boolean"
                    },
                    "status": {
                      "type": "string"
                    },
                    "integrationId": {
                      "type": "string",
                      "nullable": true
                    },
                    "apiKeyMask": {
                      "type": "string",
                      "nullable": true
                    },
                    "baseUrl": {
                      "type": "string",
                      "nullable": true
                    },
                    "issuedAt": {
                      "type": "string",
                      "format": "date-time",
                      "nullable": true
                    },
                    "availableEndpoints": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    },
                    "rateLimits": {
                      "type": "object",
                      "properties": {
                        "code": {
                          "type": "object",
                          "properties": {
                            "limit": {
                              "type": "number"
                            },
                            "ttl": {
                              "type": "number"
                            }
                          }
                        },
                        "calculate": {
                          "type": "object",
                          "properties": {
                            "limit": {
                              "type": "number"
                            },
                            "ttl": {
                              "type": "number"
                            }
                          }
                        },
                        "bonus": {
                          "type": "object",
                          "properties": {
                            "limit": {
                              "type": "number"
                            },
                            "ttl": {
                              "type": "number"
                            }
                          }
                        },
                        "refund": {
                          "type": "object",
                          "properties": {
                            "limit": {
                              "type": "number"
                            },
                            "ttl": {
                              "type": "number"
                            }
                          }
                        }
                      }
                    },
                    "message": {
                      "type": "string",
                      "nullable": true
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "delete": {
        "operationId": "PortalController_restApiIntegrationDisable",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/integrations/rest-api/issue": {
      "post": {
        "operationId": "PortalController_restApiIntegrationIssue",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "apiKey": {
                      "type": "string",
                      "nullable": true
                    }
                  },
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/integrations/telegram-mini-app": {
      "get": {
        "operationId": "PortalController_telegramMiniAppState",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "enabled": {
                      "type": "boolean"
                    },
                    "botUsername": {
                      "type": "string",
                      "nullable": true
                    },
                    "botLink": {
                      "type": "string",
                      "nullable": true
                    },
                    "miniappUrl": {
                      "type": "string",
                      "nullable": true
                    },
                    "connectionHealthy": {
                      "type": "boolean"
                    },
                    "lastSyncAt": {
                      "type": "string",
                      "format": "date-time",
                      "nullable": true
                    },
                    "integrationId": {
                      "type": "string",
                      "nullable": true
                    },
                    "tokenMask": {
                      "type": "string",
                      "nullable": true
                    },
                    "message": {
                      "type": "string",
                      "nullable": true
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "delete": {
        "operationId": "PortalController_telegramMiniAppDisconnect",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/integrations/telegram-mini-app/connect": {
      "post": {
        "operationId": "PortalController_telegramMiniAppConnect",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/settings/telegram-notify/state": {
      "get": {
        "operationId": "PortalController_telegramNotifyState",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "configured": {
                      "type": "boolean"
                    },
                    "botUsername": {
                      "type": "string",
                      "nullable": true
                    },
                    "botLink": {
                      "type": "string",
                      "nullable": true
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/settings/telegram-notify/invite": {
      "post": {
        "operationId": "PortalController_telegramNotifyInvite",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    },
                    "startUrl": {
                      "type": "string"
                    },
                    "startGroupUrl": {
                      "type": "string"
                    },
                    "token": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/settings/telegram-notify/subscribers": {
      "get": {
        "operationId": "PortalController_telegramNotifySubscribers",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": true
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/settings/telegram-notify/preferences": {
      "get": {
        "operationId": "PortalController_telegramNotifyPreferences",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "notifyOrders": {
                      "type": "boolean"
                    },
                    "notifyReviews": {
                      "type": "boolean"
                    },
                    "notifyReviewThreshold": {
                      "type": "number"
                    },
                    "notifyDailyDigest": {
                      "type": "boolean"
                    },
                    "notifyFraud": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "post": {
        "operationId": "PortalController_telegramNotifyUpdatePreferences",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "notifyOrders": {
                      "type": "boolean"
                    },
                    "notifyReviews": {
                      "type": "boolean"
                    },
                    "notifyDailyDigest": {
                      "type": "boolean"
                    },
                    "notifyFraud": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/settings/telegram-notify/subscribers/{id}/deactivate": {
      "post": {
        "operationId": "PortalController_telegramNotifyDeactivate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/integrations/telegram-mini-app/check": {
      "post": {
        "operationId": "PortalController_telegramMiniAppCheck",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/integrations/telegram-mini-app/link": {
      "post": {
        "operationId": "PortalController_telegramMiniAppLink",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "deepLink": {
                      "type": "string"
                    },
                    "startParam": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/integrations/telegram-mini-app/setup-menu": {
      "post": {
        "operationId": "PortalController_telegramMiniAppSetupMenu",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/gifts": {
      "get": {
        "operationId": "PortalController_giftsList",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": true
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/settings": {
      "get": {
        "operationId": "PortalController_getSettings",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MerchantSettingsRespDto"
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "put": {
        "operationId": "PortalController_updateSettings",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateMerchantSettingsDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MerchantSettingsRespDto"
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/settings/name": {
      "get": {
        "operationId": "PortalController_getMerchantName",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string"
                    },
                    "initialName": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "put": {
        "operationId": "PortalController_updateMerchantName",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateMerchantNameDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    },
                    "name": {
                      "type": "string"
                    },
                    "initialName": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/settings/timezone": {
      "get": {
        "operationId": "PortalController_getTimezoneSetting",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      },
      "put": {
        "operationId": "PortalController_updateTimezoneSetting",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateTimezoneDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/settings/support": {
      "get": {
        "operationId": "PortalController_getSupportSetting",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      },
      "put": {
        "operationId": "PortalController_updateSupportSetting",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/catalog/categories": {
      "get": {
        "operationId": "PortalController_listCatalogCategories",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CategoryDto"
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "post": {
        "operationId": "PortalController_createCatalogCategory",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateCategoryDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CategoryDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/catalog/categories/{categoryId}": {
      "put": {
        "operationId": "PortalController_updateCatalogCategory",
        "parameters": [
          {
            "name": "categoryId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateCategoryDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CategoryDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "delete": {
        "operationId": "PortalController_deleteCatalogCategory",
        "parameters": [
          {
            "name": "categoryId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/catalog/categories/reorder": {
      "post": {
        "operationId": "PortalController_reorderCatalogCategories",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReorderCategoriesDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    },
                    "updated": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/catalog/products": {
      "get": {
        "operationId": "PortalController_listCatalogProducts",
        "parameters": [
          {
            "name": "categoryId",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "points",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "with_points",
                "without_points",
                "all"
              ]
            }
          },
          {
            "name": "search",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "externalId",
            "required": false,
            "in": "query",
            "description": "Фильтр по внешнему ID товара",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "offset",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductListResponseDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "post": {
        "operationId": "PortalController_createCatalogProduct",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateProductDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/catalog/products/{productId}": {
      "get": {
        "operationId": "PortalController_getCatalogProduct",
        "parameters": [
          {
            "name": "productId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "put": {
        "operationId": "PortalController_updateCatalogProduct",
        "parameters": [
          {
            "name": "productId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateProductDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "delete": {
        "operationId": "PortalController_deleteCatalogProduct",
        "parameters": [
          {
            "name": "productId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/catalog/products/bulk": {
      "post": {
        "operationId": "PortalController_bulkCatalogProducts",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProductBulkActionDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    },
                    "updated": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/catalog/import/commerce-ml": {
      "post": {
        "operationId": "PortalController_importCommerceMl",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ImportCatalogDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/catalog/import/moysklad": {
      "post": {
        "operationId": "PortalController_importMoySklad",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ImportCatalogDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/outlets": {
      "get": {
        "operationId": "PortalController_listOutlets",
        "parameters": [
          {
            "name": "status",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "search",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortalOutletListResponseDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "post": {
        "operationId": "PortalController_createOutlet",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePortalOutletDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortalOutletDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/outlets/{outletId}": {
      "get": {
        "operationId": "PortalController_getOutlet",
        "parameters": [
          {
            "name": "outletId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortalOutletDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "put": {
        "operationId": "PortalController_updateOutlet",
        "parameters": [
          {
            "name": "outletId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePortalOutletDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortalOutletDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      },
      "delete": {
        "operationId": "PortalController_deleteOutlet",
        "parameters": [
          {
            "name": "outletId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/outlets/{outletId}/pos": {
      "put": {
        "operationId": "PortalController_updateOutletPos",
        "parameters": [
          {
            "name": "outletId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateOutletPosDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortalOutletDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/outlets/{outletId}/status": {
      "put": {
        "operationId": "PortalController_updateOutletStatus",
        "parameters": [
          {
            "name": "outletId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateOutletStatusDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortalOutletDto"
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/transactions": {
      "get": {
        "operationId": "PortalController_listTransactions",
        "parameters": [
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "type",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "staffId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/TransactionItemDto"
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/receipts": {
      "get": {
        "operationId": "PortalController_listReceipts",
        "parameters": [
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "orderId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ReceiptDto"
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/ledger": {
      "get": {
        "operationId": "PortalController_listLedger",
        "parameters": [
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "before",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "type",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/LedgerEntryDto"
                  }
                }
              }
            }
          }
        },
        "tags": [
          "portal"
        ]
      }
    },
    "/portal/audiences": {
      "get": {
        "operationId": "CustomerAudiencesController_listAudiences",
        "parameters": [
          {
            "name": "includeSystem",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "CustomerAudiences"
        ]
      },
      "post": {
        "operationId": "CustomerAudiencesController_createAudience",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "CustomerAudiences"
        ]
      }
    },
    "/portal/audiences/{id}": {
      "put": {
        "operationId": "CustomerAudiencesController_updateAudience",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "CustomerAudiences"
        ]
      },
      "delete": {
        "operationId": "CustomerAudiencesController_deleteAudience",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "CustomerAudiences"
        ]
      }
    },
    "/portal/audiences/{id}/activate": {
      "post": {
        "operationId": "CustomerAudiencesController_activateAudience",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "CustomerAudiences"
        ]
      }
    },
    "/portal/audiences/{id}/refresh": {
      "post": {
        "operationId": "CustomerAudiencesController_refreshAudience",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "CustomerAudiences"
        ]
      }
    },
    "/portal/communications/templates": {
      "get": {
        "operationId": "CommunicationsController_listTemplates",
        "parameters": [
          {
            "name": "channel",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Communications"
        ]
      },
      "post": {
        "operationId": "CommunicationsController_createTemplate",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Communications"
        ]
      }
    },
    "/portal/communications/templates/{id}": {
      "put": {
        "operationId": "CommunicationsController_updateTemplate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Communications"
        ]
      }
    },
    "/portal/communications/templates/{id}/archive": {
      "post": {
        "operationId": "CommunicationsController_archiveTemplate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Communications"
        ]
      }
    },
    "/portal/communications/tasks": {
      "get": {
        "operationId": "CommunicationsController_listTasks",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Communications"
        ]
      },
      "post": {
        "operationId": "CommunicationsController_createTask",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Communications"
        ]
      }
    },
    "/portal/communications/tasks/{id}/status": {
      "post": {
        "operationId": "CommunicationsController_updateStatus",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Communications"
        ]
      }
    },
    "/portal/communications/tasks/{id}/recipients": {
      "get": {
        "operationId": "CommunicationsController_recipients",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Communications"
        ]
      }
    },
    "/portal/communications/assets/{id}": {
      "get": {
        "operationId": "CommunicationsController_downloadAsset",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Communications"
        ]
      }
    },
    "/api/integrations/outlets": {
      "get": {
        "operationId": "IntegrationsLoyaltyController_outlets",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IntegrationOutletsRespDto"
                }
              }
            }
          }
        },
        "tags": [
          "integrations"
        ]
      }
    },
    "/api/integrations/devices": {
      "get": {
        "operationId": "IntegrationsLoyaltyController_devices",
        "parameters": [
          {
            "name": "outlet_id",
            "required": false,
            "in": "query",
            "description": "Фильтр по торговой точке",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IntegrationDevicesRespDto"
                }
              }
            }
          }
        },
        "tags": [
          "integrations"
        ]
      }
    },
    "/api/integrations/operations": {
      "get": {
        "operationId": "IntegrationsLoyaltyController_operations",
        "parameters": [
          {
            "name": "invoice_num",
            "required": false,
            "in": "query",
            "description": "Поиск по invoice_num/receipt_num",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": false,
            "in": "query",
            "description": "Начало интервала (ISO 8601)",
            "schema": {
              "format": "date-time",
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": false,
            "in": "query",
            "description": "Конец интервала (ISO 8601)",
            "schema": {
              "format": "date-time",
              "type": "string"
            }
          },
          {
            "name": "device_id",
            "required": false,
            "in": "query",
            "description": "Фильтр по устройству (id или код)",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outlet_id",
            "required": false,
            "in": "query",
            "description": "Фильтр по торговой точке",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Ограничение количества записей (1–500)",
            "schema": {
              "minimum": 1,
              "maximum": 500,
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IntegrationOperationsRespDto"
                }
              }
            }
          }
        },
        "tags": [
          "integrations"
        ]
      }
    },
    "/api/integrations/code": {
      "post": {
        "operationId": "IntegrationsLoyaltyController_code",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IntegrationCodeRequestDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "integrations"
        ]
      }
    },
    "/api/integrations/calculate/action": {
      "post": {
        "operationId": "IntegrationsLoyaltyController_calculateAction",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IntegrationCalculateActionDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "integrations"
        ]
      }
    },
    "/api/integrations/calculate/bonus": {
      "post": {
        "operationId": "IntegrationsLoyaltyController_calculateBonusPreview",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IntegrationCalculateBonusDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "integrations"
        ]
      }
    },
    "/api/integrations/bonus": {
      "post": {
        "operationId": "IntegrationsLoyaltyController_bonus",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IntegrationBonusDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "integrations"
        ]
      }
    },
    "/api/integrations/refund": {
      "post": {
        "operationId": "IntegrationsLoyaltyController_refund",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IntegrationRefundDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "integrations"
        ]
      }
    },
    "/import-export/import/customers": {
      "post": {
        "operationId": "ImportExportController_importCustomers",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary"
                  },
                  "merchantId": {
                    "type": "string"
                  },
                  "format": {
                    "type": "string",
                    "enum": [
                      "csv",
                      "excel"
                    ]
                  },
                  "updateExisting": {
                    "type": "boolean"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Импортировать клиентов из CSV/Excel файла",
        "tags": [
          "Import/Export"
        ]
      }
    },
    "/import-export/export/customers": {
      "get": {
        "operationId": "ImportExportController_exportCustomers",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "format",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "fields",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "minBalance",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "maxBalance",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "hasTransactions",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "createdFrom",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "createdTo",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "batch",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Экспортировать клиентов в CSV/Excel файл",
        "tags": [
          "Import/Export"
        ]
      }
    },
    "/import-export/export/transactions": {
      "get": {
        "operationId": "ImportExportController_exportTransactions",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "type",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "staffId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "batch",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Экспортировать транзакции в CSV (стрим)",
        "tags": [
          "Import/Export"
        ]
      }
    },
    "/import-export/import/transactions": {
      "post": {
        "operationId": "ImportExportController_importTransactions",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary"
                  },
                  "merchantId": {
                    "type": "string"
                  },
                  "format": {
                    "type": "string",
                    "enum": [
                      "csv",
                      "excel"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Импортировать транзакции из CSV/Excel файла",
        "tags": [
          "Import/Export"
        ]
      }
    },
    "/import-export/template": {
      "get": {
        "operationId": "ImportExportController_getImportTemplate",
        "parameters": [
          {
            "name": "type",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "format",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Скачать шаблон для импорта",
        "tags": [
          "Import/Export"
        ]
      }
    },
    "/import-export/bulk-update/customers": {
      "post": {
        "operationId": "ImportExportController_bulkUpdateCustomers",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Массовое обновление данных клиентов",
        "tags": [
          "Import/Export"
        ]
      }
    },
    "/import-export/stats/{merchantId}": {
      "get": {
        "operationId": "ImportExportController_getImportExportStats",
        "parameters": [
          {
            "name": "merchantId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Получить статистику импорта/экспорта",
        "tags": [
          "Import/Export"
        ]
      }
    },
    "/admin/merchants": {
      "get": {
        "operationId": "AdminMerchantsController_listMerchants",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "admin-merchants"
        ]
      },
      "post": {
        "operationId": "AdminMerchantsController_createMerchant",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "admin-merchants"
        ]
      }
    },
    "/admin/merchants/{id}": {
      "get": {
        "operationId": "AdminMerchantsController_getMerchant",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "admin-merchants"
        ]
      },
      "put": {
        "operationId": "AdminMerchantsController_updateMerchant",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "admin-merchants"
        ]
      }
    },
    "/admin/merchants/{id}/settings": {
      "put": {
        "operationId": "AdminMerchantsController_updateSettings",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "admin-merchants"
        ]
      }
    },
    "/admin/merchants/{id}/cashier/rotate": {
      "post": {
        "operationId": "AdminMerchantsController_rotateCashier",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "admin-merchants"
        ]
      }
    },
    "/admin/merchants/{id}/subscription": {
      "post": {
        "operationId": "AdminMerchantsController_grantSubscription",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "admin-merchants"
        ]
      },
      "delete": {
        "operationId": "AdminMerchantsController_resetSubscription",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "admin-merchants"
        ]
      }
    },
    "/notifications/telegram-notify/state": {
      "get": {
        "operationId": "AdminNotificationsController_state",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "AdminNotifications"
        ]
      }
    },
    "/notifications/telegram-notify/set-webhook": {
      "post": {
        "operationId": "AdminNotificationsController_setWebhook",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "AdminNotifications"
        ]
      }
    },
    "/notifications/telegram-notify/delete-webhook": {
      "post": {
        "operationId": "AdminNotificationsController_deleteWebhook",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "AdminNotifications"
        ]
      }
    },
    "/portal/staff": {
      "get": {
        "operationId": "StaffController_list",
        "parameters": [
          {
            "name": "page",
            "required": false,
            "in": "query",
            "schema": {
              "$ref": "#/components/schemas/Object"
            }
          },
          {
            "name": "pageSize",
            "required": false,
            "in": "query",
            "schema": {
              "$ref": "#/components/schemas/Object"
            }
          },
          {
            "name": "search",
            "required": false,
            "in": "query",
            "description": "Поиск по имени/телефону/email",
            "schema": {
              "maxLength": 100,
              "type": "string"
            }
          },
          {
            "name": "status",
            "required": false,
            "in": "query",
            "description": "Фильтр по статусу",
            "schema": {
              "type": "string",
              "enum": [
                "ACTIVE",
                "PENDING",
                "SUSPENDED",
                "FIRED",
                "ARCHIVED",
                "ALL"
              ]
            }
          },
          {
            "name": "outletId",
            "required": false,
            "in": "query",
            "description": "Фильтр по торговой точке",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "groupId",
            "required": false,
            "in": "query",
            "description": "Фильтр по группе доступа",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "portalOnly",
            "required": false,
            "in": "query",
            "description": "Только сотрудники с доступом в портал",
            "schema": {
              "type": "boolean"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-staff"
        ]
      },
      "post": {
        "operationId": "StaffController_create",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpsertStaffDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-staff"
        ]
      }
    },
    "/portal/staff/{id}": {
      "get": {
        "operationId": "StaffController_get",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-staff"
        ]
      },
      "put": {
        "operationId": "StaffController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpsertStaffDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-staff"
        ]
      }
    },
    "/portal/staff/{id}/status": {
      "post": {
        "operationId": "StaffController_changeStatus",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChangeStaffStatusDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-staff"
        ]
      }
    },
    "/portal/staff/access/{accessId}/rotate": {
      "post": {
        "operationId": "StaffController_rotatePin",
        "parameters": [
          {
            "name": "accessId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-staff"
        ]
      }
    },
    "/portal/staff/access/{accessId}/revoke": {
      "post": {
        "operationId": "StaffController_revokePin",
        "parameters": [
          {
            "name": "accessId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-staff"
        ]
      }
    },
    "/portal/staff/{id}/access": {
      "get": {
        "operationId": "StaffController_listAccess",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-staff"
        ]
      },
      "post": {
        "operationId": "StaffController_assignAccess",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AssignStaffAccessDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-staff"
        ]
      }
    },
    "/portal/staff/{id}/access/{outletId}": {
      "delete": {
        "operationId": "StaffController_revokeAccess",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-staff"
        ]
      }
    },
    "/portal/staff/{id}/access/{outletId}/regenerate-pin": {
      "post": {
        "operationId": "StaffController_regenerateOutletPin",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "outletId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-staff"
        ]
      }
    },
    "/portal/access-groups": {
      "get": {
        "operationId": "AccessGroupsController_list",
        "parameters": [
          {
            "name": "page",
            "required": false,
            "in": "query",
            "schema": {
              "$ref": "#/components/schemas/Object"
            }
          },
          {
            "name": "pageSize",
            "required": false,
            "in": "query",
            "schema": {
              "$ref": "#/components/schemas/Object"
            }
          },
          {
            "name": "scope",
            "required": false,
            "in": "query",
            "description": "Фильтр по области действия",
            "schema": {
              "type": "string",
              "enum": [
                "PORTAL",
                "CASHIER",
                "API",
                "ALL"
              ]
            }
          },
          {
            "name": "search",
            "required": false,
            "in": "query",
            "description": "Поиск по названию",
            "schema": {
              "maxLength": 80,
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-access-groups"
        ]
      },
      "post": {
        "operationId": "AccessGroupsController_create",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-access-groups"
        ]
      }
    },
    "/portal/access-groups/{id}": {
      "put": {
        "operationId": "AccessGroupsController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-access-groups"
        ]
      },
      "delete": {
        "operationId": "AccessGroupsController_remove",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-access-groups"
        ]
      }
    },
    "/portal/access-groups/{id}/members": {
      "post": {
        "operationId": "AccessGroupsController_setMembers",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetAccessGroupMembersDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-access-groups"
        ]
      }
    },
    "/portal/cashier/credentials": {
      "get": {
        "operationId": "CashierController_credentials",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-cashier"
        ]
      }
    },
    "/portal/cashier": {
      "get": {
        "operationId": "CashierController_summary",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-cashier"
        ]
      }
    },
    "/portal/cashier/credentials/rotate": {
      "post": {
        "operationId": "CashierController_rotateCredentials",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RotateCashierDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-cashier"
        ]
      }
    },
    "/portal/cashier/rotate": {
      "post": {
        "operationId": "CashierController_rotate",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RotateCashierDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-cashier"
        ]
      }
    },
    "/portal/cashier/pins": {
      "get": {
        "operationId": "CashierController_pins",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-cashier"
        ]
      }
    },
    "/portal/cashier/activation-codes": {
      "get": {
        "operationId": "CashierController_activationCodes",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-cashier"
        ]
      },
      "post": {
        "operationId": "CashierController_issueActivationCodes",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IssueCashierActivationCodesDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-cashier"
        ]
      }
    },
    "/portal/cashier/activation-codes/revoke": {
      "post": {
        "operationId": "CashierController_revokeActivationCode",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-cashier"
        ]
      }
    },
    "/portal/cashier/device-sessions": {
      "get": {
        "operationId": "CashierController_deviceSessions",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "portal-cashier"
        ]
      }
    },
    "/portal/cashier/device-sessions/revoke": {
      "post": {
        "operationId": "CashierController_revokeDeviceSession",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "portal-cashier"
        ]
      }
    },
    "/portal/loyalty/mechanics": {
      "get": {
        "operationId": "MechanicsController_list",
        "parameters": [
          {
            "name": "status",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Mechanics"
        ]
      },
      "post": {
        "operationId": "MechanicsController_create",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Mechanics"
        ]
      }
    },
    "/portal/loyalty/mechanics/{id}": {
      "put": {
        "operationId": "MechanicsController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Mechanics"
        ]
      },
      "delete": {
        "operationId": "MechanicsController_remove",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Mechanics"
        ]
      }
    },
    "/portal/loyalty/mechanics/{id}/status": {
      "post": {
        "operationId": "MechanicsController_changeStatus",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Mechanics"
        ]
      }
    },
    "/portal/loyalty/promotions": {
      "get": {
        "operationId": "PromotionsController_list",
        "parameters": [
          {
            "name": "status",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Promotions"
        ]
      },
      "post": {
        "operationId": "PromotionsController_create",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Promotions"
        ]
      }
    },
    "/portal/loyalty/promotions/{id}": {
      "put": {
        "operationId": "PromotionsController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Promotions"
        ]
      },
      "get": {
        "operationId": "PromotionsController_getById",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Promotions"
        ]
      },
      "delete": {
        "operationId": "PromotionsController_delete",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Promotions"
        ]
      }
    },
    "/portal/loyalty/promotions/{id}/status": {
      "post": {
        "operationId": "PromotionsController_changeStatus",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Promotions"
        ]
      }
    },
    "/portal/loyalty/promotions/bulk/status": {
      "post": {
        "operationId": "PromotionsController_bulkStatus",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Promotions"
        ]
      }
    },
    "/portal/loyalty/operations": {
      "get": {
        "operationId": "OperationsLogController_list",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "OperationsLog"
        ]
      }
    },
    "/portal/loyalty/tiers": {
      "get": {
        "operationId": "TiersController_list",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Tiers"
        ]
      },
      "post": {
        "operationId": "TiersController_create",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Tiers"
        ]
      }
    },
    "/portal/loyalty/tiers/{tierId}": {
      "get": {
        "operationId": "TiersController_detail",
        "parameters": [
          {
            "name": "tierId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Tiers"
        ]
      },
      "put": {
        "operationId": "TiersController_update",
        "parameters": [
          {
            "name": "tierId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Tiers"
        ]
      },
      "delete": {
        "operationId": "TiersController_remove",
        "parameters": [
          {
            "name": "tierId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Tiers"
        ]
      }
    },
    "/portal/loyalty/tiers/{tierId}/customers": {
      "get": {
        "operationId": "TiersController_members",
        "parameters": [
          {
            "name": "tierId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "cursor",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Tiers"
        ]
      }
    },
    "/portal/loyalty/redeem-limits": {
      "get": {
        "operationId": "RedeemLimitsController_getSettings",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "RedeemLimits"
        ]
      },
      "put": {
        "operationId": "RedeemLimitsController_updateSettings",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "RedeemLimits"
        ]
      }
    }
  },
  "info": {
    "title": "Loyalty API",
    "description": "Draft OpenAPI for loyalty endpoints",
    "version": "0.1.0",
    "contact": {}
  },
  "tags": [],
  "servers": [],
  "components": {
    "schemas": {
      "QuoteRedeemRespDto": {
        "type": "object",
        "properties": {
          "canRedeem": {
            "type": "boolean"
          },
          "discountToApply": {
            "type": "number"
          },
          "pointsToBurn": {
            "type": "number"
          },
          "finalPayable": {
            "type": "number"
          },
          "postEarnPoints": {
            "type": "number"
          },
          "postEarnOnAmount": {
            "type": "number"
          },
          "holdId": {
            "type": "string"
          },
          "message": {
            "type": "string"
          }
        },
        "required": [
          "canRedeem",
          "discountToApply",
          "pointsToBurn",
          "finalPayable"
        ]
      },
      "QuoteEarnRespDto": {
        "type": "object",
        "properties": {
          "canEarn": {
            "type": "boolean"
          },
          "pointsToEarn": {
            "type": "number"
          },
          "holdId": {
            "type": "string"
          },
          "message": {
            "type": "string"
          }
        },
        "required": [
          "canEarn",
          "pointsToEarn"
        ]
      },
      "CashierCustomerResolveDto": {
        "type": "object",
        "properties": {
          "merchantId": {
            "type": "string"
          },
          "userToken": {
            "type": "string"
          }
        },
        "required": [
          "merchantId",
          "userToken"
        ]
      },
      "CashierCustomerResolveRespDto": {
        "type": "object",
        "properties": {
          "customerId": {
            "type": "string"
          },
          "name": {
            "type": "object",
            "nullable": true
          },
          "balance": {
            "type": "object",
            "nullable": true
          },
          "redeemLimitBps": {
            "type": "object",
            "nullable": true
          },
          "minPaymentAmount": {
            "type": "object",
            "nullable": true
          }
        },
        "required": [
          "customerId"
        ]
      },
      "ErrorDto": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string"
          },
          "message": {
            "type": "string"
          },
          "statusCode": {
            "type": "number"
          },
          "requestId": {
            "type": "string"
          },
          "path": {
            "type": "string"
          },
          "timestamp": {
            "type": "string"
          }
        },
        "required": [
          "error",
          "message",
          "statusCode"
        ]
      },
      "QrMintDto": {
        "type": "object",
        "properties": {
          "customerId": {
            "type": "string"
          },
          "ttlSec": {
            "type": "number",
            "minimum": 10
          },
          "merchantId": {
            "type": "string"
          },
          "initData": {
            "type": "string",
            "description": "Telegram initData для серверной проверки подписи"
          }
        },
        "required": [
          "customerId"
        ]
      },
      "QrMintRespDto": {
        "type": "object",
        "properties": {
          "token": {
            "type": "string"
          },
          "ttl": {
            "type": "number"
          }
        },
        "required": [
          "token",
          "ttl"
        ]
      },
      "LoyaltyPositionDto": {
        "type": "object",
        "properties": {
          "productId": {
            "type": "string",
            "description": "Внутренний ID товара"
          },
          "externalProvider": {
            "type": "string",
            "description": "Провайдер внешней системы (iiko, r_keeper, MoySklad и т.п.)"
          },
          "externalId": {
            "type": "string",
            "description": "Внешний ID товара в указанной системе"
          },
          "barcode": {
            "type": "string",
            "description": "Штрихкод товара"
          },
          "sku": {
            "type": "string",
            "description": "Артикул/SKU товара"
          },
          "name": {
            "type": "string",
            "description": "Название товара"
          },
          "qty": {
            "type": "number",
            "description": "Количество",
            "example": 1
          },
          "price": {
            "type": "number",
            "description": "Цена за единицу",
            "example": 450
          }
        },
        "required": [
          "qty",
          "price"
        ]
      },
      "QuoteDto": {
        "type": "object",
        "properties": {
          "mode": {
            "type": "string",
            "enum": [
              "redeem",
              "earn"
            ]
          },
          "merchantId": {
            "type": "string"
          },
          "userToken": {
            "type": "string",
            "description": "customerId или JWT"
          },
          "orderId": {
            "type": "string"
          },
          "total": {
            "type": "number",
            "minimum": 0
          },
          "redeemAmount": {
            "type": "number",
            "description": "Сумма списания в баллах (в рублях)",
            "minimum": 0
          },
          "outletId": {
            "type": "string"
          },
          "staffId": {
            "type": "string"
          },
          "deviceId": {
            "type": "string",
            "description": "Идентификатор устройства (код из настроек торговой точки)"
          },
          "positions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LoyaltyPositionDto"
            }
          }
        },
        "required": [
          "mode",
          "merchantId",
          "userToken",
          "orderId",
          "total"
        ]
      },
      "CommitDto": {
        "type": "object",
        "properties": {
          "merchantId": {
            "type": "string"
          },
          "holdId": {
            "type": "string"
          },
          "orderId": {
            "type": "string"
          },
          "receiptNumber": {
            "type": "string"
          },
          "provider": {
            "type": "string"
          },
          "positions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LoyaltyPositionDto"
            }
          }
        },
        "required": [
          "merchantId",
          "holdId",
          "orderId"
        ]
      },
      "CommitRespDto": {
        "type": "object",
        "properties": {
          "ok": {
            "type": "boolean"
          },
          "alreadyCommitted": {
            "type": "boolean"
          },
          "receiptId": {
            "type": "string"
          },
          "redeemApplied": {
            "type": "number"
          },
          "earnApplied": {
            "type": "number"
          }
        },
        "required": [
          "ok"
        ]
      },
      "OkDto": {
        "type": "object",
        "properties": {
          "ok": {
            "type": "boolean"
          }
        },
        "required": [
          "ok"
        ]
      },
      "BalanceDto": {
        "type": "object",
        "properties": {
          "merchantId": {
            "type": "string"
          },
          "customerId": {
            "type": "string"
          },
          "balance": {
            "type": "number"
          }
        },
        "required": [
          "merchantId",
          "customerId",
          "balance"
        ]
      },
      "ReviewsSharePlatformOutletDto": {
        "type": "object",
        "properties": {
          "outletId": {
            "type": "string"
          },
          "url": {
            "type": "string"
          }
        },
        "required": [
          "outletId",
          "url"
        ]
      },
      "ReviewsSharePlatformDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "enabled": {
            "type": "boolean"
          },
          "url": {
            "type": "object",
            "nullable": true
          },
          "outlets": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ReviewsSharePlatformOutletDto"
            }
          }
        },
        "required": [
          "id",
          "enabled",
          "outlets"
        ]
      },
      "ReviewsShareSettingsDto": {
        "type": "object",
        "properties": {
          "enabled": {
            "type": "boolean"
          },
          "threshold": {
            "type": "number"
          },
          "platforms": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ReviewsSharePlatformDto"
            }
          }
        },
        "required": [
          "enabled",
          "threshold",
          "platforms"
        ]
      },
      "PublicSettingsDto": {
        "type": "object",
        "properties": {
          "merchantId": {
            "type": "string"
          },
          "qrTtlSec": {
            "type": "number"
          },
          "miniappThemePrimary": {
            "type": "object",
            "nullable": true
          },
          "miniappThemeBg": {
            "type": "object",
            "nullable": true
          },
          "miniappLogoUrl": {
            "type": "object",
            "nullable": true
          },
          "supportTelegram": {
            "type": "object",
            "nullable": true
          },
          "reviewsEnabled": {
            "type": "object",
            "nullable": true
          },
          "reviewsShare": {
            "nullable": true,
            "allOf": [
              {
                "$ref": "#/components/schemas/ReviewsShareSettingsDto"
              }
            ]
          }
        },
        "required": [
          "merchantId",
          "qrTtlSec"
        ]
      },
      "RefundDto": {
        "type": "object",
        "properties": {
          "merchantId": {
            "type": "string"
          },
          "invoice_num": {
            "type": "string"
          },
          "order_id": {
            "type": "string",
            "description": "ID операции лояльности (order_id/receiptId)"
          },
          "receiptNumber": {
            "type": "string"
          },
          "deviceId": {
            "type": "string",
            "description": "Идентификатор устройства, с которого оформляется возврат"
          },
          "operationDate": {
            "type": "string",
            "description": "Дата операции (ISO 8601)"
          }
        },
        "required": [
          "merchantId"
        ]
      },
      "RefundRespDto": {
        "type": "object",
        "properties": {
          "ok": {
            "type": "boolean"
          },
          "share": {
            "type": "number"
          },
          "pointsRestored": {
            "type": "number"
          },
          "pointsRevoked": {
            "type": "number"
          }
        },
        "required": [
          "ok",
          "share",
          "pointsRestored",
          "pointsRevoked"
        ]
      },
      "CustomerProfileDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "object",
            "nullable": true
          },
          "gender": {
            "type": "string",
            "enum": [
              "male",
              "female"
            ],
            "nullable": true
          },
          "birthDate": {
            "type": "string",
            "format": "date",
            "nullable": true
          },
          "customerId": {
            "type": "object",
            "nullable": true
          }
        }
      },
      "CustomerPhoneStatusDto": {
        "type": "object",
        "properties": {
          "hasPhone": {
            "type": "boolean"
          }
        },
        "required": [
          "hasPhone"
        ]
      },
      "CustomerProfileSaveDto": {
        "type": "object",
        "properties": {
          "merchantId": {
            "type": "string"
          },
          "customerId": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "gender": {
            "type": "string",
            "enum": [
              "male",
              "female"
            ]
          },
          "birthDate": {
            "type": "string",
            "description": "YYYY-MM-DD"
          },
          "phone": {
            "type": "string"
          }
        },
        "required": [
          "merchantId",
          "customerId",
          "name",
          "gender",
          "birthDate"
        ]
      },
      "TransactionItemDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "type": {
            "type": "string",
            "enum": [
              "EARN",
              "REDEEM",
              "REFUND",
              "ADJUST",
              "CAMPAIGN",
              "REFERRAL",
              "REGISTRATION"
            ]
          },
          "amount": {
            "type": "number"
          },
          "orderId": {
            "type": "object"
          },
          "receiptNumber": {
            "type": "object",
            "nullable": true
          },
          "receiptTotal": {
            "type": "object",
            "nullable": true,
            "description": "Сумма чека (рубли) для операций с orderId"
          },
          "redeemApplied": {
            "type": "object",
            "nullable": true,
            "description": "Списано баллов по чеку (рубли) для операций с orderId"
          },
          "customerId": {
            "type": "string"
          },
          "createdAt": {
            "type": "string"
          },
          "outletId": {
            "type": "object"
          },
          "deviceId": {
            "type": "object",
            "nullable": true,
            "description": "Идентификатор устройства (код)"
          },
          "outletPosType": {
            "type": "string",
            "enum": [
              "SMART",
              "PC_POS",
              "VIRTUAL"
            ],
            "nullable": true
          },
          "outletLastSeenAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "staffId": {
            "type": "object"
          },
          "reviewId": {
            "type": "object",
            "nullable": true,
            "description": "Идентификатор созданного отзыва"
          },
          "reviewRating": {
            "type": "object",
            "nullable": true,
            "description": "Рейтинг из созданного отзыва"
          },
          "reviewCreatedAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Дата и время создания отзыва"
          },
          "reviewDismissedAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Когда пользователь закрыл окно отзыва без оценки"
          },
          "pending": {
            "type": "boolean",
            "description": "Флаг отложенного начисления (на удержании)"
          },
          "maturesAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Когда баллы будут зачислены"
          },
          "daysUntilMature": {
            "type": "object",
            "nullable": true,
            "description": "Сколько дней осталось до зачисления (округлено вверх)"
          },
          "source": {
            "type": "object",
            "nullable": true,
            "description": "Источник операции из metadata (например MANUAL_ACCRUAL, COMPLIMENTARY)"
          },
          "comment": {
            "type": "object",
            "nullable": true,
            "description": "Комментарий или описание операции из metadata"
          },
          "canceledAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Когда операция была отменена (если применимо)"
          },
          "relatedOperationAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Дата и время исходной операции (для возвратов)"
          }
        },
        "required": [
          "id",
          "type",
          "amount",
          "customerId",
          "createdAt"
        ]
      },
      "MerchantSettingsRespDto": {
        "type": "object",
        "properties": {
          "merchantId": {
            "type": "string"
          },
          "earnBps": {
            "type": "number"
          },
          "redeemLimitBps": {
            "type": "number"
          },
          "qrTtlSec": {
            "type": "number"
          },
          "webhookUrl": {
            "type": "object"
          },
          "webhookSecret": {
            "type": "object"
          },
          "webhookKeyId": {
            "type": "object"
          },
          "redeemCooldownSec": {
            "type": "number"
          },
          "earnCooldownSec": {
            "type": "number"
          },
          "redeemDailyCap": {
            "type": "object"
          },
          "earnDailyCap": {
            "type": "object"
          },
          "maxOutlets": {
            "type": "object",
            "description": "Максимальное количество торговых точек"
          },
          "requireJwtForQuote": {
            "type": "boolean"
          },
          "rulesJson": {
            "type": "object"
          },
          "pointsTtlDays": {
            "type": "object",
            "description": "TTL баллов (в днях). Предпросмотр через outbox, списание отключено."
          },
          "earnDelayDays": {
            "type": "object",
            "description": "Задержка начисления (в днях)"
          },
          "telegramBotToken": {
            "type": "object"
          },
          "telegramBotUsername": {
            "type": "object"
          },
          "telegramStartParamRequired": {
            "type": "boolean"
          },
          "miniappBaseUrl": {
            "type": "object"
          },
          "miniappThemePrimary": {
            "type": "object"
          },
          "miniappThemeBg": {
            "type": "object"
          },
          "miniappLogoUrl": {
            "type": "object"
          },
          "outboxPausedUntil": {
            "type": "object"
          },
          "timezone": {
            "type": "string",
            "description": "Код часового пояса в формате «МСК±N»",
            "enum": [
              "MSK-1",
              "MSK+0",
              "MSK+1",
              "MSK+2",
              "MSK+3",
              "MSK+4",
              "MSK+5",
              "MSK+6",
              "MSK+7",
              "MSK+8",
              "MSK+9"
            ]
          }
        },
        "required": [
          "merchantId",
          "earnBps",
          "redeemLimitBps",
          "qrTtlSec",
          "redeemCooldownSec",
          "earnCooldownSec",
          "requireJwtForQuote",
          "timezone"
        ]
      },
      "UpdateMerchantSettingsDto": {
        "type": "object",
        "properties": {
          "earnBps": {
            "type": "number",
            "minimum": 0,
            "maximum": 10000,
            "description": "10000 б.п. = 100%"
          },
          "redeemLimitBps": {
            "type": "number",
            "minimum": 0,
            "maximum": 10000,
            "description": "Лимит списания, 5000 = 50%"
          },
          "qrTtlSec": {
            "type": "number",
            "minimum": 15,
            "maximum": 600
          },
          "webhookUrl": {
            "type": "string"
          },
          "webhookSecret": {
            "type": "string"
          },
          "webhookKeyId": {
            "type": "string"
          },
          "webhookSecretNext": {
            "type": "string"
          },
          "webhookKeyIdNext": {
            "type": "string"
          },
          "useWebhookNext": {
            "type": "boolean"
          },
          "redeemCooldownSec": {
            "type": "number",
            "minimum": 0,
            "maximum": 86400
          },
          "earnCooldownSec": {
            "type": "number",
            "minimum": 0,
            "maximum": 86400
          },
          "redeemDailyCap": {
            "type": "number",
            "minimum": 0
          },
          "earnDailyCap": {
            "type": "number",
            "minimum": 0
          },
          "maxOutlets": {
            "type": "number",
            "minimum": 1,
            "description": "Максимальное количество торговых точек (без лимита, если не задано)"
          },
          "requireJwtForQuote": {
            "type": "boolean"
          },
          "rulesJson": {
            "type": "object",
            "description": "JSON-правила для earnBps/redeemLimitBps"
          },
          "pointsTtlDays": {
            "type": "number",
            "minimum": 0,
            "description": "TTL баллов (в днях). 0 или отсутствие — отключено"
          },
          "earnDelayDays": {
            "type": "number",
            "minimum": 0,
            "description": "Задержка начисления (в днях). 0 или отсутствие — немедленно"
          },
          "telegramBotToken": {
            "type": "string",
            "description": "Telegram Bot Token для мини-аппы мерчанта"
          },
          "telegramBotUsername": {
            "type": "string",
            "description": "Telegram Bot Username (например, @my_bot)"
          },
          "telegramStartParamRequired": {
            "type": "boolean",
            "description": "Требовать start_param при запуске мини-аппы"
          },
          "miniappBaseUrl": {
            "type": "string",
            "description": "Базовый URL мини-аппы (для Deep Link)"
          },
          "miniappThemePrimary": {
            "type": "string",
            "description": "Цвет основной темы мини-аппы (HEX)"
          },
          "miniappThemeBg": {
            "type": "string",
            "description": "Цвет фона мини-аппы (HEX)"
          },
          "miniappLogoUrl": {
            "type": "string",
            "description": "URL логотипа мини-аппы"
          },
          "timezone": {
            "type": "string",
            "description": "Часовой пояс мерчанта в формате «МСК±N»",
            "enum": [
              "MSK-1",
              "MSK+0",
              "MSK+1",
              "MSK+2",
              "MSK+3",
              "MSK+4",
              "MSK+5",
              "MSK+6",
              "MSK+7",
              "MSK+8",
              "MSK+9"
            ]
          }
        }
      },
      "OutletDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "merchantId": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "address": {
            "type": "object"
          },
          "status": {
            "type": "string"
          },
          "hidden": {
            "type": "boolean"
          },
          "posType": {
            "type": "string",
            "enum": [
              "SMART",
              "PC_POS",
              "VIRTUAL"
            ],
            "nullable": true
          },
          "posLastSeenAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "updatedAt": {
            "format": "date-time",
            "type": "string"
          }
        },
        "required": [
          "id",
          "merchantId",
          "name",
          "status",
          "hidden",
          "createdAt",
          "updatedAt"
        ]
      },
      "CreateOutletDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "address": {
            "type": "string"
          }
        },
        "required": [
          "name"
        ]
      },
      "UpdateOutletDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "address": {
            "type": "string"
          }
        }
      },
      "UpdateOutletPosDto": {
        "type": "object",
        "properties": {
          "posType": {
            "type": "string",
            "enum": [
              "SMART",
              "PC_POS",
              "VIRTUAL"
            ],
            "description": "Последний активный POS-тип",
            "nullable": true
          },
          "posLastSeenAt": {
            "type": "string",
            "format": "date-time",
            "description": "Метка последней активности POS",
            "nullable": true
          }
        }
      },
      "UpdateOutletStatusDto": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "ACTIVE",
              "INACTIVE"
            ]
          }
        },
        "required": [
          "status"
        ]
      },
      "StaffDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "merchantId": {
            "type": "string"
          },
          "login": {
            "type": "object"
          },
          "email": {
            "type": "object"
          },
          "role": {
            "type": "string",
            "enum": [
              "ADMIN",
              "MERCHANT",
              "CASHIER"
            ]
          },
          "status": {
            "type": "string"
          },
          "allowedOutletId": {
            "type": "object",
            "description": "Ограничение доступа сотрудника на конкретную торговую точку"
          },
          "apiKeyHash": {
            "type": "object"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          }
        },
        "required": [
          "id",
          "merchantId",
          "role",
          "status",
          "createdAt"
        ]
      },
      "CreateStaffDto": {
        "type": "object",
        "properties": {
          "login": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "role": {
            "type": "string",
            "enum": [
              "ADMIN",
              "MERCHANT",
              "CASHIER"
            ]
          },
          "firstName": {
            "type": "string"
          },
          "lastName": {
            "type": "string"
          },
          "position": {
            "type": "string"
          },
          "phone": {
            "type": "string"
          },
          "comment": {
            "type": "string"
          },
          "avatarUrl": {
            "type": "string"
          },
          "canAccessPortal": {
            "type": "boolean"
          },
          "password": {
            "type": "string",
            "description": "Пароль для входа в портал (минимум 6 символов)"
          }
        }
      },
      "UpdateStaffDto": {
        "type": "object",
        "properties": {
          "login": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "role": {
            "type": "string",
            "enum": [
              "ADMIN",
              "MERCHANT",
              "CASHIER"
            ]
          },
          "status": {
            "type": "string"
          },
          "allowedOutletId": {
            "type": "string",
            "description": "Ограничение доступа сотрудника на конкретную торговую точку"
          },
          "firstName": {
            "type": "string"
          },
          "lastName": {
            "type": "string"
          },
          "position": {
            "type": "string"
          },
          "phone": {
            "type": "string"
          },
          "comment": {
            "type": "string"
          },
          "avatarUrl": {
            "type": "string"
          },
          "canAccessPortal": {
            "type": "boolean"
          },
          "password": {
            "type": "string",
            "description": "Новый пароль для входа в портал"
          },
          "currentPassword": {
            "type": "string",
            "description": "Текущий пароль (для смены пользователем)"
          }
        }
      },
      "TokenRespDto": {
        "type": "object",
        "properties": {
          "token": {
            "type": "string"
          }
        },
        "required": [
          "token"
        ]
      },
      "OutboxEventDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "merchantId": {
            "type": "string"
          },
          "eventType": {
            "type": "string"
          },
          "payload": {
            "type": "object"
          },
          "status": {
            "type": "string"
          },
          "retries": {
            "type": "number"
          },
          "nextRetryAt": {
            "type": "object"
          },
          "lastError": {
            "type": "object"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "updatedAt": {
            "format": "date-time",
            "type": "string"
          }
        },
        "required": [
          "id",
          "merchantId",
          "eventType",
          "payload",
          "status",
          "retries",
          "createdAt",
          "updatedAt"
        ]
      },
      "BulkUpdateRespDto": {
        "type": "object",
        "properties": {
          "ok": {
            "type": "boolean"
          },
          "updated": {
            "type": "number"
          }
        },
        "required": [
          "ok",
          "updated"
        ]
      },
      "ReceiptDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "merchantId": {
            "type": "string"
          },
          "customerId": {
            "type": "string"
          },
          "orderId": {
            "type": "string"
          },
          "receiptNumber": {
            "type": "object"
          },
          "total": {
            "type": "number"
          },
          "redeemApplied": {
            "type": "number"
          },
          "earnApplied": {
            "type": "number"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "outletId": {
            "type": "object"
          },
          "outletPosType": {
            "type": "string",
            "enum": [
              "SMART",
              "PC_POS",
              "VIRTUAL"
            ],
            "nullable": true
          },
          "outletLastSeenAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "staffId": {
            "type": "object"
          }
        },
        "required": [
          "id",
          "merchantId",
          "customerId",
          "orderId",
          "total",
          "redeemApplied",
          "earnApplied",
          "createdAt"
        ]
      },
      "LedgerEntryDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "merchantId": {
            "type": "string"
          },
          "customerId": {
            "type": "object"
          },
          "debit": {
            "type": "string"
          },
          "credit": {
            "type": "string"
          },
          "amount": {
            "type": "number"
          },
          "orderId": {
            "type": "object"
          },
          "receiptId": {
            "type": "object"
          },
          "outletId": {
            "type": "object"
          },
          "outletPosType": {
            "type": "string",
            "enum": [
              "SMART",
              "PC_POS",
              "VIRTUAL"
            ],
            "nullable": true
          },
          "outletLastSeenAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "staffId": {
            "type": "object"
          },
          "meta": {
            "type": "object"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          }
        },
        "required": [
          "id",
          "merchantId",
          "debit",
          "credit",
          "amount",
          "createdAt"
        ]
      },
      "Function": {
        "type": "object",
        "properties": {}
      },
      "UpdateRfmSettingsDto": {
        "type": "object",
        "properties": {
          "recencyMode": {
            "type": "string",
            "enum": [
              "auto",
              "manual"
            ],
            "description": "Режим расчёта давности покупок",
            "default": "auto"
          },
          "recencyDays": {
            "type": "number",
            "minimum": 1,
            "description": "После какого количества дней клиента считаем потерянным"
          },
          "frequencyMode": {
            "type": "string",
            "enum": [
              "auto",
              "manual"
            ],
            "description": "Режим порога для частоты покупок"
          },
          "frequencyThreshold": {
            "type": "number",
            "minimum": 1,
            "description": "Порог количества покупок для сверх-лояльных при режиме manual"
          },
          "moneyMode": {
            "type": "string",
            "enum": [
              "auto",
              "manual"
            ],
            "description": "Режим порога для Money (суммы покупок)"
          },
          "moneyThreshold": {
            "type": "number",
            "minimum": 0,
            "description": "Порог суммы покупок/чека для самых крупных клиентов"
          }
        },
        "required": [
          "recencyMode",
          "recencyDays",
          "frequencyMode",
          "moneyMode"
        ]
      },
      "UpdateMerchantNameDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Новое название компании в портале мерчанта",
            "minLength": 2,
            "maxLength": 120
          }
        },
        "required": [
          "name"
        ]
      },
      "UpdateTimezoneDto": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "enum": [
              "MSK-1",
              "MSK+0",
              "MSK+1",
              "MSK+2",
              "MSK+3",
              "MSK+4",
              "MSK+5",
              "MSK+6",
              "MSK+7",
              "MSK+8",
              "MSK+9"
            ]
          }
        },
        "required": [
          "code"
        ]
      },
      "CategoryDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "slug": {
            "type": "string"
          },
          "description": {
            "type": "object"
          },
          "imageUrl": {
            "type": "object"
          },
          "parentId": {
            "type": "object"
          },
          "order": {
            "type": "number"
          },
          "status": {
            "type": "string"
          }
        },
        "required": [
          "id",
          "name",
          "slug",
          "order",
          "status"
        ]
      },
      "CreateCategoryDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "slug": {
            "type": "string",
            "description": "Если не указан — будет сгенерирован из name"
          },
          "description": {
            "type": "string"
          },
          "imageUrl": {
            "type": "string"
          },
          "parentId": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": [
              "ACTIVE",
              "ARCHIVED"
            ]
          },
          "assignProductIds": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "name"
        ]
      },
      "UpdateCategoryDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "slug": {
            "type": "string",
            "description": "Если не указан — будет сгенерирован из name"
          },
          "description": {
            "type": "string"
          },
          "imageUrl": {
            "type": "string"
          },
          "parentId": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": [
              "ACTIVE",
              "ARCHIVED"
            ]
          },
          "assignProductIds": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "unassignProductIds": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "ReorderCategoryDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "order": {
            "type": "number"
          }
        },
        "required": [
          "id",
          "order"
        ]
      },
      "ReorderCategoriesDto": {
        "type": "object",
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ReorderCategoryDto"
            }
          }
        },
        "required": [
          "items"
        ]
      },
      "ProductListItemDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "categoryId": {
            "type": "object"
          },
          "categoryName": {
            "type": "object"
          },
          "previewImage": {
            "type": "object"
          },
          "accruePoints": {
            "type": "boolean"
          },
          "allowRedeem": {
            "type": "boolean"
          },
          "redeemPercent": {
            "type": "number"
          },
          "purchasesMonth": {
            "type": "number"
          },
          "purchasesTotal": {
            "type": "number"
          },
          "externalId": {
            "type": "object"
          }
        },
        "required": [
          "id",
          "name",
          "accruePoints",
          "allowRedeem",
          "redeemPercent",
          "purchasesMonth",
          "purchasesTotal"
        ]
      },
      "ProductListResponseDto": {
        "type": "object",
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductListItemDto"
            }
          },
          "total": {
            "type": "number"
          }
        },
        "required": [
          "items",
          "total"
        ]
      },
      "ProductImageInputDto": {
        "type": "object",
        "properties": {
          "url": {
            "type": "string"
          },
          "alt": {
            "type": "string"
          },
          "position": {
            "type": "number"
          }
        },
        "required": [
          "url"
        ]
      },
      "ProductVariantInputDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "sku": {
            "type": "string"
          },
          "price": {
            "type": "number"
          },
          "notes": {
            "type": "string"
          },
          "position": {
            "type": "number"
          }
        },
        "required": [
          "name"
        ]
      },
      "ProductStockInputDto": {
        "type": "object",
        "properties": {
          "label": {
            "type": "string"
          },
          "outletId": {
            "type": "string"
          },
          "price": {
            "type": "number"
          },
          "balance": {
            "type": "number"
          },
          "currency": {
            "type": "string"
          }
        },
        "required": [
          "label"
        ]
      },
      "ProductDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "categoryId": {
            "type": "object"
          },
          "categoryName": {
            "type": "object"
          },
          "previewImage": {
            "type": "object"
          },
          "accruePoints": {
            "type": "boolean"
          },
          "allowRedeem": {
            "type": "boolean"
          },
          "redeemPercent": {
            "type": "number"
          },
          "purchasesMonth": {
            "type": "number"
          },
          "purchasesTotal": {
            "type": "number"
          },
          "externalId": {
            "type": "object"
          },
          "order": {
            "type": "number"
          },
          "description": {
            "type": "object"
          },
          "iikoProductId": {
            "type": "object"
          },
          "hasVariants": {
            "type": "boolean"
          },
          "priceEnabled": {
            "type": "boolean"
          },
          "price": {
            "type": "object"
          },
          "disableCart": {
            "type": "boolean"
          },
          "weightValue": {
            "type": "object"
          },
          "weightUnit": {
            "type": "object"
          },
          "heightCm": {
            "type": "object"
          },
          "widthCm": {
            "type": "object"
          },
          "depthCm": {
            "type": "object"
          },
          "proteins": {
            "type": "object"
          },
          "fats": {
            "type": "object"
          },
          "carbs": {
            "type": "object"
          },
          "calories": {
            "type": "object"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "images": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductImageInputDto"
            }
          },
          "variants": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductVariantInputDto"
            }
          },
          "stocks": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductStockInputDto"
            }
          }
        },
        "required": [
          "id",
          "name",
          "accruePoints",
          "allowRedeem",
          "redeemPercent",
          "purchasesMonth",
          "purchasesTotal",
          "order",
          "hasVariants",
          "priceEnabled",
          "disableCart",
          "tags",
          "images",
          "variants",
          "stocks"
        ]
      },
      "CreateProductDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "sku": {
            "type": "string"
          },
          "code": {
            "type": "string"
          },
          "barcode": {
            "type": "string",
            "description": "Штрихкод"
          },
          "unit": {
            "type": "string",
            "description": "Единица измерения (шт, кг и т.п.)"
          },
          "externalProvider": {
            "type": "string",
            "description": "Провайдер внешней системы (iiko, r_keeper, MoySklad и т.п.)"
          },
          "externalId": {
            "type": "string",
            "description": "Внешний ID товара"
          },
          "categoryId": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "order": {
            "type": "number",
            "description": "Позиция в каталоге (чем меньше, тем выше)"
          },
          "iikoProductId": {
            "type": "string",
            "description": "ID связанного товара в iiko (или другой системе)"
          },
          "hasVariants": {
            "type": "boolean"
          },
          "priceEnabled": {
            "type": "boolean"
          },
          "price": {
            "type": "number"
          },
          "disableCart": {
            "type": "boolean",
            "description": "Тумблер «Запретить добавление в корзину» (false = можно добавлять)"
          },
          "accruePoints": {
            "type": "boolean"
          },
          "allowRedeem": {
            "type": "boolean"
          },
          "redeemPercent": {
            "type": "number",
            "description": "Процент оплаты баллами 0..100"
          },
          "weightValue": {
            "type": "number",
            "description": "Вес"
          },
          "weightUnit": {
            "type": "string",
            "description": "Единица измерения веса (г/кг)"
          },
          "heightCm": {
            "type": "number"
          },
          "widthCm": {
            "type": "number"
          },
          "depthCm": {
            "type": "number"
          },
          "proteins": {
            "type": "number"
          },
          "fats": {
            "type": "number"
          },
          "carbs": {
            "type": "number"
          },
          "calories": {
            "type": "number"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "images": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductImageInputDto"
            }
          },
          "variants": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductVariantInputDto"
            }
          },
          "stocks": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductStockInputDto"
            }
          }
        },
        "required": [
          "name"
        ]
      },
      "UpdateProductDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "sku": {
            "type": "string"
          },
          "code": {
            "type": "string"
          },
          "barcode": {
            "type": "string",
            "description": "Штрихкод"
          },
          "unit": {
            "type": "string",
            "description": "Единица измерения (шт, кг и т.п.)"
          },
          "externalProvider": {
            "type": "string",
            "description": "Провайдер внешней системы (iiko, r_keeper, MoySklad и т.п.)"
          },
          "externalId": {
            "type": "string",
            "description": "Внешний ID товара"
          },
          "categoryId": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "order": {
            "type": "number",
            "description": "Позиция в каталоге (чем меньше, тем выше)"
          },
          "iikoProductId": {
            "type": "string",
            "description": "ID связанного товара в iiko (или другой системе)"
          },
          "hasVariants": {
            "type": "boolean"
          },
          "priceEnabled": {
            "type": "boolean"
          },
          "price": {
            "type": "number"
          },
          "disableCart": {
            "type": "boolean",
            "description": "Тумблер «Запретить добавление в корзину» (false = можно добавлять)"
          },
          "accruePoints": {
            "type": "boolean"
          },
          "allowRedeem": {
            "type": "boolean"
          },
          "redeemPercent": {
            "type": "number",
            "description": "Процент оплаты баллами 0..100"
          },
          "weightValue": {
            "type": "number",
            "description": "Вес"
          },
          "weightUnit": {
            "type": "string",
            "description": "Единица измерения веса (г/кг)"
          },
          "heightCm": {
            "type": "number"
          },
          "widthCm": {
            "type": "number"
          },
          "depthCm": {
            "type": "number"
          },
          "proteins": {
            "type": "number"
          },
          "fats": {
            "type": "number"
          },
          "carbs": {
            "type": "number"
          },
          "calories": {
            "type": "number"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "images": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductImageInputDto"
            }
          },
          "variants": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductVariantInputDto"
            }
          },
          "stocks": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductStockInputDto"
            }
          }
        }
      },
      "ProductBulkActionDto": {
        "type": "object",
        "properties": {
          "action": {
            "type": "string",
            "enum": [
              "allow_redeem",
              "forbid_redeem",
              "delete"
            ]
          },
          "ids": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "action",
          "ids"
        ]
      },
      "ImportProductDto": {
        "type": "object",
        "properties": {
          "externalId": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "sku": {
            "type": "string"
          },
          "barcode": {
            "type": "string"
          },
          "unit": {
            "type": "string"
          },
          "price": {
            "type": "number"
          },
          "code": {
            "type": "string"
          }
        },
        "required": [
          "externalId",
          "name"
        ]
      },
      "ImportCatalogDto": {
        "type": "object",
        "properties": {
          "externalProvider": {
            "type": "string",
            "description": "Провайдер внешней системы (будет переопределён роутом)"
          },
          "products": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ImportProductDto"
            }
          }
        },
        "required": [
          "products"
        ]
      },
      "PortalDeviceDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "code": {
            "type": "string"
          },
          "archivedAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "updatedAt": {
            "format": "date-time",
            "type": "string"
          }
        },
        "required": [
          "id",
          "code",
          "createdAt",
          "updatedAt"
        ]
      },
      "PortalOutletDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "works": {
            "type": "boolean"
          },
          "staffCount": {
            "type": "number"
          },
          "devices": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PortalDeviceDto"
            }
          },
          "reviewsShareLinks": {
            "type": "object",
            "description": "Ссылки на карточки отзывов по площадкам",
            "additionalProperties": {
              "type": "string",
              "nullable": true
            },
            "nullable": true
          }
        },
        "required": [
          "id",
          "name",
          "works",
          "devices"
        ]
      },
      "PortalOutletListResponseDto": {
        "type": "object",
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PortalOutletDto"
            }
          },
          "total": {
            "type": "number"
          }
        },
        "required": [
          "items",
          "total"
        ]
      },
      "CreatePortalDeviceDto": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Идентификатор устройства (латиница/цифры/._-)",
            "minLength": 2,
            "maxLength": 64
          }
        },
        "required": [
          "code"
        ]
      },
      "CreatePortalOutletDto": {
        "type": "object",
        "properties": {
          "works": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          },
          "devices": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreatePortalDeviceDto"
            }
          },
          "reviewsShareLinks": {
            "type": "object",
            "description": "Ссылки на карточки отзывов по площадкам",
            "additionalProperties": {
              "type": "string",
              "nullable": true
            }
          }
        },
        "required": [
          "works",
          "name"
        ]
      },
      "UpdatePortalOutletDto": {
        "type": "object",
        "properties": {
          "works": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          },
          "devices": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreatePortalDeviceDto"
            }
          },
          "reviewsShareLinks": {
            "type": "object",
            "description": "Ссылки на карточки отзывов по площадкам",
            "additionalProperties": {
              "type": "string",
              "nullable": true
            }
          }
        }
      },
      "IntegrationOutletManagerDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "code": {
            "type": "object",
            "nullable": true,
            "description": "Код/внешний ID"
          }
        },
        "required": [
          "id",
          "name"
        ]
      },
      "IntegrationOutletDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "address": {
            "type": "object",
            "nullable": true
          },
          "description": {
            "type": "object",
            "nullable": true
          },
          "managers": {
            "description": "Сотрудники, привязанные к точке",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IntegrationOutletManagerDto"
            }
          }
        },
        "required": [
          "id",
          "name"
        ]
      },
      "IntegrationOutletsRespDto": {
        "type": "object",
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IntegrationOutletDto"
            }
          }
        },
        "required": [
          "items"
        ]
      },
      "IntegrationDeviceDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "code": {
            "type": "string",
            "description": "Код устройства (из настроек торговой точки, регистр сохраняется)"
          },
          "outlet_id": {
            "type": "string"
          }
        },
        "required": [
          "id",
          "code",
          "outlet_id"
        ]
      },
      "IntegrationDevicesRespDto": {
        "type": "object",
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IntegrationDeviceDto"
            }
          }
        },
        "required": [
          "items"
        ]
      },
      "IntegrationOperationDto": {
        "type": "object",
        "properties": {
          "kind": {
            "type": "string",
            "enum": [
              "purchase",
              "refund"
            ]
          },
          "id_client": {
            "type": "string",
            "description": "ID клиента в системе лояльности"
          },
          "invoice_num": {
            "type": "string",
            "description": "Кастомный номер чека от мерчанта"
          },
          "order_id": {
            "type": "string",
            "description": "Внутренний ID операции лояльности"
          },
          "receipt_num": {
            "type": "object",
            "nullable": true
          },
          "operation_date": {
            "type": "string",
            "description": "Дата и время операции (operationDate/createdAt)",
            "format": "date-time"
          },
          "total": {
            "type": "object",
            "description": "Сумма чека (для возврата — сумма возврата)",
            "nullable": true
          },
          "redeem_applied": {
            "type": "object",
            "description": "Списанные бонусы для покупки",
            "nullable": true
          },
          "earn_applied": {
            "type": "object",
            "description": "Начисленные бонусы для покупки",
            "nullable": true
          },
          "points_restored": {
            "type": "object",
            "description": "Восстановленные бонусы при возврате",
            "nullable": true
          },
          "points_revoked": {
            "type": "object",
            "description": "Списанные (отозванные) бонусы при возврате",
            "nullable": true
          },
          "balance_before": {
            "type": "object",
            "description": "Баланс до операции (если удалось восстановить)",
            "nullable": true
          },
          "balance_after": {
            "type": "object",
            "description": "Баланс после операции (если удалось восстановить)",
            "nullable": true
          },
          "outlet_id": {
            "type": "object",
            "nullable": true
          },
          "device_id": {
            "type": "object",
            "description": "ID устройства",
            "nullable": true
          },
          "device_code": {
            "type": "object",
            "description": "Код устройства (как в настройках)",
            "nullable": true
          },
          "canceled_at": {
            "type": "string",
            "description": "Пометка отменённого чека (full refund)",
            "format": "date-time",
            "nullable": true
          },
          "points_delta": {
            "type": "object",
            "description": "Чистое изменение баланса по операции",
            "nullable": true
          }
        },
        "required": [
          "kind",
          "id_client",
          "invoice_num",
          "order_id",
          "operation_date"
        ]
      },
      "IntegrationOperationsRespDto": {
        "type": "object",
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IntegrationOperationDto"
            }
          }
        },
        "required": [
          "items"
        ]
      },
      "IntegrationCodeRequestDto": {
        "type": "object",
        "properties": {
          "user_token": {
            "type": "string"
          }
        },
        "required": [
          "user_token"
        ]
      },
      "IntegrationCalculateActionItemDto": {
        "type": "object",
        "properties": {
          "id_product": {
            "type": "string",
            "description": "Внешний ID товара (артикул id_product)"
          },
          "qty": {
            "type": "number",
            "description": "Количество"
          },
          "price": {
            "type": "number",
            "description": "Цена за единицу"
          },
          "name": {
            "type": "string",
            "description": "Название товара"
          }
        },
        "required": [
          "id_product",
          "qty",
          "price"
        ]
      },
      "IntegrationCalculateActionDto": {
        "type": "object",
        "properties": {
          "id_client": {
            "type": "string",
            "description": "ID клиента в системе лояльности"
          },
          "phone": {
            "type": "string",
            "description": "Телефон клиента"
          },
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IntegrationCalculateActionItemDto"
            }
          },
          "outlet_id": {
            "type": "string",
            "description": "ID торговой точки (опционально)"
          }
        },
        "required": [
          "items"
        ]
      },
      "IntegrationCalculateBonusItemDto": {
        "type": "object",
        "properties": {
          "id_product": {
            "type": "string",
            "description": "Внешний ID товара (артикул id_product)"
          },
          "name": {
            "type": "string",
            "description": "Название товара"
          },
          "qty": {
            "type": "number",
            "description": "Количество",
            "default": 1
          },
          "price": {
            "type": "number",
            "description": "Цена после применения акций"
          },
          "actions": {
            "description": "ID применённых акций",
            "type": "array",
            "items": {
              "type": "array"
            }
          },
          "action_names": {
            "description": "Названия применённых акций",
            "type": "array",
            "items": {
              "type": "array"
            }
          }
        },
        "required": [
          "id_product",
          "price"
        ]
      },
      "IntegrationCalculateBonusDto": {
        "type": "object",
        "properties": {
          "user_token": {
            "type": "string",
            "description": "Токен клиента (QR)"
          },
          "id_client": {
            "type": "string",
            "description": "ID клиента в системе лояльности"
          },
          "phone": {
            "type": "string",
            "description": "Телефон клиента"
          },
          "outlet_id": {
            "type": "string"
          },
          "total": {
            "type": "number",
            "description": "Сумма заказа (если items не передаётся)",
            "minimum": 0
          },
          "paid_bonus": {
            "type": "number",
            "description": "Желаемое списание баллов (для расчёта остатка)",
            "minimum": 0
          },
          "items": {
            "description": "Состав заказа (опционально, если передан total)",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IntegrationCalculateBonusItemDto"
            }
          }
        }
      },
      "IntegrationItemDto": {
        "type": "object",
        "properties": {
          "id_product": {
            "type": "string",
            "description": "Внешний ID товара (id_product / артикул)"
          },
          "productId": {
            "type": "string",
            "description": "Внутренний ID товара"
          },
          "name": {
            "type": "string",
            "description": "Название товара"
          },
          "qty": {
            "type": "number",
            "description": "Количество",
            "example": 1
          },
          "price": {
            "type": "number",
            "description": "Цена за единицу",
            "example": 450
          },
          "base_price": {
            "type": "number",
            "description": "Цена до применения акции (опционально)"
          },
          "actions": {
            "description": "ID применённых акций",
            "type": "array",
            "items": {
              "type": "array"
            }
          },
          "action_names": {
            "description": "Названия применённых акций",
            "type": "array",
            "items": {
              "type": "array"
            }
          }
        },
        "required": [
          "qty",
          "price"
        ]
      },
      "IntegrationBonusDto": {
        "type": "object",
        "properties": {
          "user_token": {
            "type": "string"
          },
          "id_client": {
            "type": "string",
            "description": "ID клиента в системе лояльности"
          },
          "invoice_num": {
            "type": "string",
            "description": "Кастомный номер чека от мерчанта (опционально)"
          },
          "idempotency_key": {
            "type": "string",
            "description": "Уникальный ключ идемпотентности операции"
          },
          "total": {
            "type": "number",
            "description": "Сумма заказа (если не передана — считаем по items)",
            "minimum": 0
          },
          "device_id": {
            "type": "string",
            "description": "Идентификатор устройства (код из настроек торговой точки)"
          },
          "outlet_id": {
            "type": "string"
          },
          "outlet_name": {
            "type": "string",
            "description": "Название торговой точки (опционально)"
          },
          "manager_id": {
            "type": "string",
            "description": "Идентификатор сотрудника/кассира (managerId)"
          },
          "manager_name": {
            "type": "string",
            "description": "Имя сотрудника (опционально)"
          },
          "paid_bonus": {
            "type": "number",
            "minimum": 0
          },
          "bonus_value": {
            "type": "number",
            "minimum": 0
          },
          "operation_date": {
            "type": "string",
            "description": "Дата операции (ISO 8601), может быть в прошлом"
          },
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IntegrationItemDto"
            }
          }
        },
        "required": [
          "idempotency_key"
        ]
      },
      "IntegrationRefundDto": {
        "type": "object",
        "properties": {
          "invoice_num": {
            "type": "string",
            "description": "Кастомный номер чека от мерчанта"
          },
          "order_id": {
            "type": "string",
            "description": "ID операции лояльности (order_id)"
          },
          "device_id": {
            "type": "string",
            "description": "Идентификатор устройства (код из настроек торговой точки)"
          },
          "outlet_id": {
            "type": "string"
          },
          "operation_date": {
            "type": "string",
            "description": "Дата операции (ISO 8601), может быть в прошлом"
          }
        }
      },
      "Object": {
        "type": "object",
        "properties": {}
      },
      "UpsertStaffDto": {
        "type": "object",
        "properties": {
          "login": {
            "type": "object",
            "description": "Логин для входа"
          },
          "email": {
            "type": "object",
            "description": "Email"
          },
          "phone": {
            "type": "object",
            "description": "Телефон"
          },
          "firstName": {
            "type": "object",
            "description": "Имя"
          },
          "lastName": {
            "type": "object",
            "description": "Фамилия"
          },
          "position": {
            "type": "object",
            "description": "Должность"
          },
          "comment": {
            "type": "object",
            "description": "Комментарий"
          },
          "role": {
            "type": "string",
            "enum": [
              "ADMIN",
              "MERCHANT",
              "CASHIER"
            ]
          },
          "status": {
            "type": "string",
            "enum": [
              "ACTIVE",
              "PENDING",
              "SUSPENDED",
              "FIRED",
              "ARCHIVED"
            ]
          },
          "canAccessPortal": {
            "type": "boolean",
            "description": "Может ли сотрудник использовать портал"
          },
          "portalAccessEnabled": {
            "type": "boolean",
            "description": "Доступ в портал включён"
          },
          "outletIds": {
            "description": "Список точек",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "accessGroupIds": {
            "description": "Список групп доступа",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "pinStrategy": {
            "type": "string",
            "description": "Стратегия обработки PIN при обновлении",
            "enum": [
              "KEEP",
              "ROTATE"
            ]
          },
          "password": {
            "type": "object",
            "description": "Новый пароль сотрудника",
            "minLength": 6
          },
          "currentPassword": {
            "type": "object",
            "description": "Текущий пароль сотрудника для подтверждения"
          }
        }
      },
      "ChangeStaffStatusDto": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "ACTIVE",
              "PENDING",
              "SUSPENDED",
              "FIRED",
              "ARCHIVED"
            ]
          },
          "actorId": {
            "type": "string",
            "description": "Идентификатор инициатора операции"
          }
        },
        "required": [
          "status"
        ]
      },
      "AssignStaffAccessDto": {
        "type": "object",
        "properties": {
          "outletId": {
            "type": "string",
            "description": "Идентификатор торговой точки"
          }
        },
        "required": [
          "outletId"
        ]
      },
      "SetAccessGroupMembersDto": {
        "type": "object",
        "properties": {
          "staffIds": {
            "description": "Идентификаторы сотрудников",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "staffIds"
        ]
      },
      "RotateCashierDto": {
        "type": "object",
        "properties": {
          "regenerateLogin": {
            "type": "boolean",
            "description": "Перегенерировать логин"
          }
        }
      },
      "IssueCashierActivationCodesDto": {
        "type": "object",
        "properties": {
          "count": {
            "type": "number",
            "description": "Количество кодов",
            "minimum": 1,
            "maximum": 50
          }
        },
        "required": [
          "count"
        ]
      }
    }
  }
}