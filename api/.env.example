# Core (required to start API)
DATABASE_URL=postgresql://user:password@localhost:5432/loyalty
ADMIN_KEY=change_me_admin_key

# Access keys (required if you use API key auth)
API_KEY=change_me_api_key

# JWT and Security (required for portal/admin/QR in production)
QR_JWT_SECRET=change_me_qr_secret
ADMIN_SESSION_SECRET=change_me_session_secret
PORTAL_JWT_SECRET=change_me_portal_jwt_secret
PORTAL_REFRESH_SECRET=change_me_portal_refresh_secret

# Optional - Defaults shown (CORS_ORIGINS required in production)
# NODE_ENV=development
CORS_ORIGINS=http://localhost:3001,http://localhost:3002,http://localhost:3003,http://localhost:3004
IDEMPOTENCY_TTL_HOURS=72
API_BASE_URL=http://localhost:3000
MINIAPP_BASE_URL=http://localhost:3003

# Security / proxy (optional)
# TRUST_PROXY=1
# COOKIE_SECURE=true
# ADMIN_IP_WHITELIST=1.2.3.4,5.6.7.0/24
# ADMIN_IP_ALLOW_ALL=false
# MAINTENANCE_MODE=0
# READ_ONLY_MODE=0

# Observability
SENTRY_DSN=
SENTRY_TRACES_SAMPLE_RATE=0.0
OTEL_ENABLED=0
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
# OTEL_SERVICE_NAME=loyalty-api
# APP_VERSION=dev
METRICS_TOKEN=

# Alerts (optional)
ALERT_TELEGRAM_BOT_TOKEN=
ALERT_TELEGRAM_CHAT_ID=
# 5xx alerts sampling rate (0..1)
ALERTS_5XX_SAMPLE_RATE=0.0
ALERT_OUTBOX_PENDING_THRESHOLD=200
ALERT_OUTBOX_DEAD_THRESHOLD=5
ALERT_WORKER_STALE_MINUTES=5
ALERT_MONITOR_INTERVAL_MS=60000
ALERT_REPEAT_MINUTES=30

# Workers & Feature Flags
WORKERS_ENABLED=1
# Feature flags
EARN_LOTS_FEATURE=0
LEDGER_FEATURE=0
POINTS_TTL_FEATURE=0
POINTS_TTL_BURN=0
POINTS_TTL_REMINDER=0

# Workers intervals/batches (optional)
EARN_ACTIVATION_INTERVAL_MS=900000
EARN_ACTIVATION_BATCH=500
HOLD_GC_INTERVAL_MS=60000
OUTBOX_WORKER_INTERVAL_MS=15000
OUTBOX_WORKER_CONCURRENCY=3
OUTBOX_MAX_RETRIES=10
OUTBOX_HTTP_TIMEOUT_MS=10000
OUTBOX_BACKOFF_BASE_MS=60000
OUTBOX_BACKOFF_CAP_MS=3600000
OUTBOX_RPS_DEFAULT=0
# OUTBOX_RPS_BY_MERCHANT="M1=5,M2=3"
POINTS_TTL_BURN_INTERVAL_MS=86400000
POINTS_TTL_REMINDER_INTERVAL_MS=21600000

# Hold Garbage Collector
# HOLD_GC_ENABLED=true
# HOLD_GC_INTERVAL_MS=60000

# Redis (optional but recommended)
REDIS_URL=

# Local cache (optional)
# CACHE_MAX_ENTRIES=5000
# CACHE_TTL_SETTINGS_MS=30000
# CACHE_TTL_OUTLET_MS=30000
# CACHE_TTL_STAFF_MS=15000

# Workers-only mode (disable HTTP server)
NO_HTTP=0

# Notifications (optional)
# SMTP
SMTP_HOST=
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=

# Staff notifications (optional)
TELEGRAM_NOTIFY_BOT_TOKEN=
TELEGRAM_NOTIFY_WEBHOOK_SECRET=

# Notification worker (optional)
# NOTIFY_WORKER_INTERVAL_MS=15000
# NOTIFY_WORKER_BATCH=10
# NOTIFY_BACKOFF_BASE_MS=60000
# NOTIFY_BACKOFF_CAP_MS=3600000
# NOTIFY_RPS_DEFAULT=0
# NOTIFY_RPS_BY_MERCHANT="M-1=5,M-2=3"
